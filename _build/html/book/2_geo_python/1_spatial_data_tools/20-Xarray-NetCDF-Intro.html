
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Working with NetCDF files &#8212; SENSE Training Resources</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'book/2_geo_python/1_spatial_data_tools/20-Xarray-NetCDF-Intro';</script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="2 - EO data" href="../2_eo_data.html" />
    <link rel="prev" title="Xarray" href="xarray.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/Sense-logo-4_transpCol-1024x431.png" class="logo__image only-light" alt="SENSE Training Resources - Home"/>
    <script>document.write(`<img src="../../../_static/Sense-logo-4_transpCol-1024x431.png" class="logo__image only-dark" alt="SENSE Training Resources - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Book 1 - Python Software Carpentry</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../1_python_zero2hero/book1_overview.html">0 - Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../1_python_zero2hero/1_intro.html">1 - Intro to Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/1_intro/00-Introduction.html">1.0 Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/1_intro/01-How-to-Run-Python-Code.html">1.1 How to Run Python Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/1_intro/02-Jupyter-Notebook.html">1.2 Jupyter Notebooks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/1_intro/03-Basic-Python-Syntax.html">1.3 Python Language Syntax</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../1_python_zero2hero/2_python_basics.html">2 - Python Basics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/2_python_basics/01-Semantics-Variables.html">2.1 Variables and Objects in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/2_python_basics/02-Semantics-Operators.html">2.2 Basic Python Semantics: Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/2_python_basics/03-Built-in-Scalar-Types.html">2.3 Built-In Types: Simple Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/2_python_basics/04-Built-in-Data-Structures.html">2.4 Built-In Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/2_python_basics/05-Ex-Try-Python-Basics.html">Exercise</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/2_python_basics/06-Control-Flow-Statements.html">2.5 Control Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/2_python_basics/07-Defining-Functions.html">2.6 Defining and Using Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/2_python_basics/09-Modules-and-Packages.html">Modules and Packages</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../1_python_zero2hero/3_data_analysis_visualisation.html">3 - Plotting</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/3_data_analysis_visualisation/01-Numpy-Intro.html"> Introduction to NumPy</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/3_data_analysis_visualisation/02-Matplotlib.html">Matplotlib - Intro</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/3_data_analysis_visualisation/03-Working-with-datetime.html">Working with dates and times</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/3_data_analysis_visualisation/04-Pandas-Intro.html">Introduction to pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../1_python_zero2hero/3_data_analysis_visualisation/05-Plotting-with-Seaborn.html">Statistical plotting with Seaborn</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Book 2 - GeoPython</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../book2_overview.html">0 - Overview</a></li>

<li class="toctree-l1 current active has-children"><a class="reference internal" href="../1_spatial_data_tools.html">1 - GeoPython Tools</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="00_intro_to_geospatial_data.html">Introduction to Geospatial Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="cartopy.html">Cartopy</a></li>

<li class="toctree-l2"><a class="reference internal" href="geopandas.html">GeoPandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="rasterio.html">Rasterio</a></li>
<li class="toctree-l2"><a class="reference internal" href="rioxarray.html">Rioxarray</a></li>
<li class="toctree-l2"><a class="reference internal" href="xarray.html">Xarray</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Working with NetCDF files</a></li>








</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../2_eo_data.html">2 - EO data</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../3_gee_python.html">3 - GEE Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../3_gee_python/0_First_steps.html">Linking Google Colab to your GitHub page</a></li>
<li class="toctree-l2"><a class="reference internal" href="../3_gee_python/1_Open_and_display.html">Google Earth Engine: JavaScript, but Python</a></li>

<li class="toctree-l2"><a class="reference internal" href="../3_gee_python/2_Time_series.html">ImageCollection</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Book 3 - Machine Learning for EO</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../3_ml4eo/book3_overview.html">0 - Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../3_ml4eo/2_sat_ml_intro.html">2 - Classical ML with satellite data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../3_ml4eo/2_sat_ml_intro/1_linear_regression.html">Practical 1: Linear Regression</a></li>





<li class="toctree-l2"><a class="reference internal" href="../../3_ml4eo/2_sat_ml_intro/2_classification.html">Practical 2: Classification</a></li>


<li class="toctree-l2"><a class="reference internal" href="../../3_ml4eo/2_sat_ml_intro/3_kalman_filter.html">Practical 3: Kalman Filter</a></li>


</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../3_ml4eo/3_sat_ml_deep.html">3 - Deep Learning with PyTorch</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../3_ml4eo/3_sat_ml_deep/00_intro.html">Satellite image deep learning with PyTorch</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../3_ml4eo/3_sat_ml_deep/02_segmentation_unet.html">Semantic segmentation of Aerial Imaginary with U-Net-like architectures</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../3_ml4eo/4_embeddings.html">4 - Embeddings</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../3_ml4eo/4_embeddings/notebooks/1a_Use_PCA_analysis_to_study_tile_embeddings.html">Use PCA analysis on tile embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../3_ml4eo/4_embeddings/notebooks/1b_Exploring_embedding_space_with_clustering_methods.html">How are the study tiles clustered in the embedding space?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../3_ml4eo/4_embeddings/notebooks/2_Working_with_your_own_data.html">Working with your own input data</a></li>

</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/leamhowe/sense-jb/blob/main/book/book/2_geo_python/1_spatial_data_tools/20-Xarray-NetCDF-Intro.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/leamhowe/sense-jb" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/leamhowe/sense-jb/issues/new?title=Issue%20on%20page%20%2Fbook/2_geo_python/1_spatial_data_tools/20-Xarray-NetCDF-Intro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/book/2_geo_python/1_spatial_data_tools/20-Xarray-NetCDF-Intro.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Working with NetCDF files</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Working with NetCDF files</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#netcdf-in-python">NetCDF in python</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#netcdf4">netCDF4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xarray">xarray</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-main-advantages-of-using-xarray-versus-plain-netcdf4-are">The main advantages of using xarray versus plain netCDF4 are:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xarray-as-pandas-for-n-dimensions">Xarray as Pandas for N dimensions</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-open-a-netcdf-file">Let’s open a netCDF file</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-our-dataset">Open our dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-variable-from-dataset">Extract variable from dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-data-values">Accessing data values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xarray-indexing-and-selecting-data">Xarray Indexing and selecting data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-selection-using-nearest-value">Define selection using nearest value</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-is-easy">Plotting is easy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-plotting-packages-are-still-available">Other plotting packages are still available</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aside-choice-of-colormaps">Aside: Choice of colormaps</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-operations">Arithmetic operations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#available-methods-and-statistics">Available methods and statistics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-can-easily-be-saved-to-a-new-netcdf-file">Dataset can easily be saved to a new netCDF file</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-exercise">Bonus Exercise</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#more-on-the-netcdf-file-format">More on the netCDF file format</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#history">History</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-model">Data model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tools-for-working-with-netcdf-files">Tools for working with netCDF files</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#readable-by-many-software-tools">Readable by many software tools</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-and-fortran-libraries">C and Fortran libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nco-tools">nco tools</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdo-tools">cdo tools</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-viewers">Quick viewers?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ncdump">ncdump</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="working-with-netcdf-files">
<h1>Working with NetCDF files<a class="headerlink" href="#working-with-netcdf-files" title="Link to this heading">#</a></h1>
<p>One of the most common file formats within environmental science is NetCDF (<a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">Network Common Data Form</a>).</p>
<p>This format allows for storage of multiple variables, over multiple dimensions (i.e. N-dimensional arrays).<br />
Files also contain the associated history and variable attributes.</p>
<p>Example dataset format:  (from <a class="reference external" href="http://xarray.pydata.org/en/stable/data-structures.html">http://xarray.pydata.org/en/stable/data-structures.html</a>)</p>
<br>
<img src="/home/s2112771/r/sense_cpd/sense_book/book/1_python_zero2hero/figures/dataset-diagram.png">
<br>
<p>If you’re not familiar with NetCDF, and would like to know more, there is a bit more general information at the bottom of this notebook.</p>
<p>For now, we’ll simply focus on how to access and work with these files in python …</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="netcdf-in-python">
<h1>NetCDF in python<a class="headerlink" href="#netcdf-in-python" title="Link to this heading">#</a></h1>
<p>There are a few different packages that can be used to access data from NetCDF files.<br />
These include:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://unidata.github.io/netcdf4-python/netCDF4/index.html">netCDF4</a></p>
<ul>
<li><p>Core NetCDF package within python.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://scitools.org.uk/iris/docs/latest/index.html">iris</a></p>
<ul>
<li><p>Developed for earth system data.</p></li>
<li><p>Data and metadata read into and stored within “cubes”.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="http://xarray.pydata.org/en/stable/">xarray</a></p>
<ul>
<li><p>A higher-level package, with a pandas-like interface for netCDF.</p></li>
<li><p>What we’ll focus on here today…</p></li>
</ul>
</li>
</ul>
<section id="netcdf4">
<h2>netCDF4<a class="headerlink" href="#netcdf4" title="Link to this heading">#</a></h2>
<p>Contains everything you need to read/modify/create netCDF files. e.g.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">netCDF4</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dataset</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">openfile</span> <span class="o">=</span> <span class="n">Dataset</span><span class="p">(</span><span class="s1">&#39;../data/cefas_GETM_nwes.nc4&#39;</span><span class="p">)</span>
<span class="n">bathymetry</span> <span class="o">=</span> <span class="n">openfile</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;bathymetry&#39;</span><span class="p">][:]</span>
</pre></div>
</div>
<p>Variables are read into NumPy arrays (masked arrays if missing values specified).</p>
</section>
<section id="xarray">
<h2>xarray<a class="headerlink" href="#xarray" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Alternative to plain netCDF4 access from python.</p></li>
<li><p>Brings the power of pandas to environmental sciences, by providing N-dimensional variants of the core pandas data structures.</p>
<ul>
<li><p>Worth using for N-dimensional data, even when not reading netCDF files?</p></li>
</ul>
</li>
</ul>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Pandas</p></th>
<th class="head"><p>xarray</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1-D Series</p></td>
<td><p>DataArray</p></td>
</tr>
<tr class="row-odd"><td><p>DataFrame</p></td>
<td><p>Dataset</p></td>
</tr>
</tbody>
</table>
</div>
<p>DataArray uses names for each dimension, making it easier to track than by just using axis numbers.</p>
<p>For example, if you want to average your DataArray (da) over time, it is possible to write <code class="docutils literal notranslate"><span class="pre">da.mean(dim='time')</span></code><br />
You don’t have to remember the index of the time axis.</p>
<p>Compare:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># xarray style</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">da</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2018-01-12&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;ensemble&#39;</span><span class="p">)</span>

<span class="c1"># standard numpy style</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">array</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Without xarray, you need to first check which row refers to <code class="docutils literal notranslate"><span class="pre">time='2018-01-12'</span></code>, and which dimension is relevant for the ensemble.</p>
<p>In the NumPy example, these choices are also not obvious to anyone reading the code at a later date.</p>
<section id="the-main-advantages-of-using-xarray-versus-plain-netcdf4-are">
<h3>The main advantages of using xarray versus plain netCDF4 are:<a class="headerlink" href="#the-main-advantages-of-using-xarray-versus-plain-netcdf4-are" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>intelligent selection along labelled dimensions (and also indices)</p></li>
<li><p><a class="reference external" href="http://xarray.pydata.org/en/stable/generated/xarray.DataArray.groupby.html">groupby operations</a></p></li>
<li><p>data alignment across named axes</p></li>
<li><p>IO (netcdf)</p>
<ul>
<li><p>Attributes/metadata held with the dataset.</p></li>
</ul>
</li>
<li><p>conversion from and to Pandas.DataFrames</p></li>
</ul>
</section>
</section>
<section id="xarray-as-pandas-for-n-dimensions">
<h2>Xarray as Pandas for N dimensions<a class="headerlink" href="#xarray-as-pandas-for-n-dimensions" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import everything that we are going to need... but not more</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">xarray</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">xr</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_s</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abc&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pd_s</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a    0
b    1
c    2
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#convert 1D series to ND aware DataArray </span>
<span class="n">da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">pd_s</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">da</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray (dim_0: 3)&gt; Size: 24B
array([0, 1, 2])
Coordinates:
  * dim_0    (dim_0) object 24B &#39;a&#39; &#39;b&#39; &#39;c&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#convert 2D DataFrame to ND aware Dataset</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]},</span>                         
                             <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;one&#39;</span><span class="p">,</span> <span class="s1">&#39;two&#39;</span><span class="p">,</span> <span class="s1">&#39;three&#39;</span><span class="p">])</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>one</th>
      <th>two</th>
      <th>three</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>B</th>
      <td>4</td>
      <td>5</td>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="o">.</span><span class="n">from_dataframe</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 64B
Dimensions:  (index: 2)
Coordinates:
  * index    (index) object 16B &#x27;A&#x27; &#x27;B&#x27;
Data variables:
    one      (index) int64 16B 1 4
    two      (index) int64 16B 2 5
    three    (index) int64 16B 3 6</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-80cbd3d9-be8a-4798-9db0-ef831e37fdf1' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-80cbd3d9-be8a-4798-9db0-ef831e37fdf1' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>index</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-837369a9-a290-4977-9d9b-493199480ee6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-837369a9-a290-4977-9d9b-493199480ee6' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>index</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;A&#x27; &#x27;B&#x27;</div><input id='attrs-775fc81e-7e4e-4844-978b-b59c1489fba6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-775fc81e-7e4e-4844-978b-b59c1489fba6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7e405fb-8ef3-43fa-93fd-9475aed8f6af' class='xr-var-data-in' type='checkbox'><label for='data-e7e405fb-8ef3-43fa-93fd-9475aed8f6af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;A&#x27;, &#x27;B&#x27;], dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3e7020ec-6ab4-48d2-bd41-506495f4a869' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3e7020ec-6ab4-48d2-bd41-506495f4a869' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>one</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>1 4</div><input id='attrs-01afc2f1-3fb5-4dea-af94-9b7226a3c31f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-01afc2f1-3fb5-4dea-af94-9b7226a3c31f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c8ed5e7-a99f-40f6-922b-e62f4868eaae' class='xr-var-data-in' type='checkbox'><label for='data-9c8ed5e7-a99f-40f6-922b-e62f4868eaae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([1, 4])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>two</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>2 5</div><input id='attrs-6a4324f0-31d0-464c-b9bc-5233f59e8e89' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6a4324f0-31d0-464c-b9bc-5233f59e8e89' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-191b6e55-dae0-4250-bfb6-42b0db25c7e0' class='xr-var-data-in' type='checkbox'><label for='data-191b6e55-dae0-4250-bfb6-42b0db25c7e0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([2, 5])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>three</span></div><div class='xr-var-dims'>(index)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>3 6</div><input id='attrs-d0de2b12-2bac-44db-bad7-6989e6a4b4aa' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d0de2b12-2bac-44db-bad7-6989e6a4b4aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d8a099f2-40f9-41da-bec8-ce47b8973e94' class='xr-var-data-in' type='checkbox'><label for='data-d8a099f2-40f9-41da-bec8-ce47b8973e94' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([3, 6])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f3ad1200-9159-4b96-85fc-6f31963702fd' class='xr-section-summary-in' type='checkbox'  ><label for='section-f3ad1200-9159-4b96-85fc-6f31963702fd' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>index</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-677cf06d-50f1-41c6-9938-c48f0a7bb55e' class='xr-index-data-in' type='checkbox'/><label for='index-677cf06d-50f1-41c6-9938-c48f0a7bb55e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;A&#x27;, &#x27;B&#x27;], dtype=&#x27;object&#x27;, name=&#x27;index&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-90988acc-9c44-41aa-b680-1c3677e5fe94' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-90988acc-9c44-41aa-b680-1c3677e5fe94' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="let-s-open-a-netcdf-file">
<h1>Let’s open a netCDF file<a class="headerlink" href="#let-s-open-a-netcdf-file" title="Link to this heading">#</a></h1>
<p>Xarray allows you to open both local and remote datasets.</p>
<p>Remote datasets can be accessed through <a class="reference external" href="http://xarray.pydata.org/en/stable/io.html#opendap">OpenDAP</a>, allowing you to download (and subset) data available online.<br />
e.g. you can access ocean colour data directly into python (from dataset acccessible online <a class="reference internal" href="#earthdata.nasa.gov/collaborate/open-data-services-and-software/api/opendap/opendap-servers"><span class="xref myst">here</span></a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">remote_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span>
      <span class="s1">&#39;https://oceandata.sci.gsfc.nasa.gov:443/opendap/MODISA/L3SMI/2020/176/A2020176.L3m_DAY_CHL_chlor_a_9km.nc&#39;</span><span class="p">)</span>

</pre></div>
</div>
<p>Here we’ll use a file available locally on your machine (find in your data folder): <code class="docutils literal notranslate"><span class="pre">cefas_GETM_nwes.nc4</span></code></p>
<section id="open-our-dataset">
<h2>Open our dataset<a class="headerlink" href="#open-our-dataset" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GETM</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;/home/s2112771/r/sense_cpd/sense_book/book/1_python_zero2hero/data/cefas_GETM_nwes.nc4&#39;</span><span class="p">)</span>
<span class="n">GETM</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 35MB
Dimensions:     (latc: 360, lonc: 396, time: 6, level: 5)
Coordinates:
  * latc        (latc) float64 3kB 45.4 45.45 45.5 45.55 ... 63.25 63.3 63.35
  * level       (level) float64 40B 1.0 6.0 11.0 16.0 21.0
  * lonc        (lonc) float64 3kB -17.5 -17.42 -17.34 ... 13.94 14.02 14.1
  * time        (time) datetime64[ns] 48B 1996-02-01T01:00:00 ... 1996-02-06T...
Data variables:
    bathymetry  (latc, lonc) float64 1MB ...
    h           (time, level, latc, lonc) float32 17MB ...
    temp        (time, level, latc, lonc) float32 17MB ...
Attributes:
    title:                     North West European Shelf 3nm
    history:                   Sun Nov 20 00:54:48 2016: ncks -v time,latc,lo...
    NCO:                       4.4.8
    nco_openmp_thread_number:  1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-1a0e338f-fff7-477f-adba-fd75845fbee2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-1a0e338f-fff7-477f-adba-fd75845fbee2' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latc</span>: 360</li><li><span class='xr-has-index'>lonc</span>: 396</li><li><span class='xr-has-index'>time</span>: 6</li><li><span class='xr-has-index'>level</span>: 5</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-0c19d9c5-72ef-4459-a6bf-80343a1778d9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0c19d9c5-72ef-4459-a6bf-80343a1778d9' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latc</span></div><div class='xr-var-dims'>(latc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>45.4 45.45 45.5 ... 63.3 63.35</div><input id='attrs-3fe4e8e5-6a96-4aca-9519-7a18230a3b6b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3fe4e8e5-6a96-4aca-9519-7a18230a3b6b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2564ead-12f1-4fa0-a472-65082bf75a35' class='xr-var-data-in' type='checkbox'><label for='data-b2564ead-12f1-4fa0-a472-65082bf75a35' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([45.400002, 45.450002, 45.500002, ..., 63.249999, 63.299999, 63.349999],
      shape=(360,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 6.0 11.0 16.0 21.0</div><input id='attrs-b335f806-d044-4e89-ab1a-a70fd7847f68' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b335f806-d044-4e89-ab1a-a70fd7847f68' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-981d8689-9d4a-49f3-8e0f-1cbe45de257e' class='xr-var-data-in' type='checkbox'><label for='data-981d8689-9d4a-49f3-8e0f-1cbe45de257e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>level</dd></dl></div><div class='xr-var-data'><pre>array([ 1.,  6., 11., 16., 21.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lonc</span></div><div class='xr-var-dims'>(lonc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-17.5 -17.42 -17.34 ... 14.02 14.1</div><input id='attrs-b2bb1e06-47fe-4944-b2e4-11a66abe1120' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b2bb1e06-47fe-4944-b2e4-11a66abe1120' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-abd14389-b930-40ae-8b91-f18c8223eb24' class='xr-var-data-in' type='checkbox'><label for='data-abd14389-b930-40ae-8b91-f18c8223eb24' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([-17.5 , -17.42, -17.34, ...,  13.94,  14.02,  14.1 ], shape=(396,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1996-02-01T01:00:00 ... 1996-02-...</div><input id='attrs-a16c21c0-bcfb-4242-9c40-a56c5d3d8ca4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a16c21c0-bcfb-4242-9c40-a56c5d3d8ca4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d653065c-749e-4a1e-b853-7e3d010c4e0c' class='xr-var-data-in' type='checkbox'><label for='data-d653065c-749e-4a1e-b853-7e3d010c4e0c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1996-02-01T01:00:00.000000000&#x27;, &#x27;1996-02-02T01:00:00.000000000&#x27;,
       &#x27;1996-02-03T01:00:00.000000000&#x27;, &#x27;1996-02-04T01:00:00.000000000&#x27;,
       &#x27;1996-02-05T01:00:00.000000000&#x27;, &#x27;1996-02-06T01:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-47f1d8fc-d598-429f-83da-df25b1c5a1ce' class='xr-section-summary-in' type='checkbox'  checked><label for='section-47f1d8fc-d598-429f-83da-df25b1c5a1ce' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>bathymetry</span></div><div class='xr-var-dims'>(latc, lonc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-320c3233-4c5e-4d49-8b8e-13c5427e64ac' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-320c3233-4c5e-4d49-8b8e-13c5427e64ac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e79edf4-0e65-43b2-a6e2-2de7a17078a2' class='xr-var-data-in' type='checkbox'><label for='data-0e79edf4-0e65-43b2-a6e2-2de7a17078a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>bathymetry</dd><dt><span>valid_range :</span></dt><dd>[  -5. 4000.]</dd></dl></div><div class='xr-var-data'><pre>[142560 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>h</span></div><div class='xr-var-dims'>(time, level, latc, lonc)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b97a1db7-e774-43c5-b93e-7dc97a56d662' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b97a1db7-e774-43c5-b93e-7dc97a56d662' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ae804af-1485-4447-bab1-5369ab104180' class='xr-var-data-in' type='checkbox'><label for='data-2ae804af-1485-4447-bab1-5369ab104180' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>layer thickness</dd></dl></div><div class='xr-var-data'><pre>[4276800 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temp</span></div><div class='xr-var-dims'>(time, level, latc, lonc)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-9c13ac10-2a0e-467f-ba92-8ad4067bec59' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9c13ac10-2a0e-467f-ba92-8ad4067bec59' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd9ff116-261e-4cc6-9f6a-d01a1fe6c982' class='xr-var-data-in' type='checkbox'><label for='data-fd9ff116-261e-4cc6-9f6a-d01a1fe6c982' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degC</dd><dt><span>long_name :</span></dt><dd>temperature</dd><dt><span>valid_range :</span></dt><dd>[-2. 40.]</dd></dl></div><div class='xr-var-data'><pre>[4276800 values with dtype=float32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-379002f4-425a-4134-9155-ea786f96a9a0' class='xr-section-summary-in' type='checkbox'  ><label for='section-379002f4-425a-4134-9155-ea786f96a9a0' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latc</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-e1d3d65e-9318-40ca-9ecc-86cf20e0ad86' class='xr-index-data-in' type='checkbox'/><label for='index-e1d3d65e-9318-40ca-9ecc-86cf20e0ad86' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 45.40000166334548, 45.450001656472146, 45.500001649598815,
        45.55000164272549,  45.60000163585216, 45.650001628978835,
         45.7000016221055,  45.75000161523217,  45.80000160835885,
       45.850001601485516,
       ...
       62.899999257680534,  62.94999925080721,  62.99999924393387,
        63.04999923706055,  63.09999923018722,  63.14999922331389,
        63.19999921644056, 63.249999209567235,  63.29999920269391,
        63.34999919582057],
      dtype=&#x27;float64&#x27;, name=&#x27;latc&#x27;, length=360))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>level</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-24be26cb-c40b-42b0-85e9-0ca2758e7780' class='xr-index-data-in' type='checkbox'/><label for='index-24be26cb-c40b-42b0-85e9-0ca2758e7780' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1.0, 6.0, 11.0, 16.0, 21.0], dtype=&#x27;float64&#x27;, name=&#x27;level&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lonc</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4a07c70c-2863-4098-ae39-b339280ba242' class='xr-index-data-in' type='checkbox'/><label for='index-4a07c70c-2863-4098-ae39-b339280ba242' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              -17.5, -17.419999998901528, -17.339999997803055,
       -17.259999996704583, -17.179999995606106, -17.099999994507634,
        -17.01999999340916,  -16.93999999231069, -16.859999991212216,
       -16.779999990113744,
       ...
        13.380000424010593,  13.460000425109065,  13.540000426207538,
         13.62000042730601,  13.700000428404483,  13.780000429502959,
        13.860000430601431,  13.940000431699904,  14.020000432798376,
        14.100000433896849],
      dtype=&#x27;float64&#x27;, name=&#x27;lonc&#x27;, length=396))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-876f5404-6c90-4967-b5fd-5cc9f2eb12da' class='xr-index-data-in' type='checkbox'/><label for='index-876f5404-6c90-4967-b5fd-5cc9f2eb12da' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1996-02-01 01:00:00&#x27;, &#x27;1996-02-02 01:00:00&#x27;,
               &#x27;1996-02-03 01:00:00&#x27;, &#x27;1996-02-04 01:00:00&#x27;,
               &#x27;1996-02-05 01:00:00&#x27;, &#x27;1996-02-06 01:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-94b45463-4d0f-4154-9a29-945fedfcf1a3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-94b45463-4d0f-4154-9a29-945fedfcf1a3' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>North West European Shelf 3nm</dd><dt><span>history :</span></dt><dd>Sun Nov 20 00:54:48 2016: ncks -v time,latc,lonc,level,temp,bathymetry,h -d time,0,120,24 -d level,1,25,5 /gpfs/afmcefas/share/nwes/36x36_old/timebase/nwes-3d-199602.nc cefas_GETM_nwes.nc
Mon May  9 18:50:36 2016: ncatted -a units,time,o,c,seconds since 1996-01-01 00:00:00 /gpfs/afmcefas/share/nwes/36x36_old//timebase//nwes-3d-199602.nc
Mon May  9 17:12:29 2016: ncap2 -s time=time+2678400 /gpfs/afmcefas/share/nwes/36x36_old//nwes-3d-199602.nc /gpfs/afmcefas/share/nwes/36x36_old//timebase//nwes-3d-199602.nc
Fri May  6 23:38:06 2016 : ncmerge /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.000.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.001.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.002.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.003.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.004.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.005.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.006.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.007.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.008.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.009.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.010.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.011.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.012.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.013.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.014.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.015.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.016.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.017.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.018.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.019.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.020.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.021.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.022.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.023.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.024.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.025.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.026.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.027.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.028.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.029.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.030.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.031.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.032.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.033.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.034.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.035.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.036.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.037.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.038.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.039.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.040.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.041.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.042.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.043.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.044.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.045.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.046.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.047.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.048.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.049.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.050.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.051.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.052.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.053.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.054.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.055.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.056.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.057.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.058.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.059.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.060.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.061.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.062.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.063.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.064.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.065.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.066.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.067.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.068.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.069.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.070.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.071.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.072.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.073.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.074.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.075.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.076.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.077.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.078.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.079.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.080.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.081.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.082.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.083.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.084.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.085.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.086.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.087.par.nc /gpfs/scratchenv/uck09rvu/prep_par/north_west_european_shelf.3d.par.199602.nc 
 Fri May  6 23:26:28 2016: ncks -v grid_type,vert_cord,ioff,joff,dlon,dlat,lonc,latc,level,bathymetry,time,elev,u,v,h,hcc,uu,vv,w,salt,temp,sigma_t,nuh /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.000.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.000.par.nc
Generated by getm, ver. 2.2.2</dd><dt><span>NCO :</span></dt><dd>4.4.8</dd><dt><span>nco_openmp_thread_number :</span></dt><dd>1</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>We can extract information on the dimensions, coordinates and attributes of the dataset</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List dimensions</span>
<span class="n">GETM</span><span class="o">.</span><span class="n">dims</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FrozenMappingWarningOnValuesAccess({&#39;latc&#39;: 360, &#39;lonc&#39;: 396, &#39;time&#39;: 6, &#39;level&#39;: 5})
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract coordinates</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">GETM</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;latc&#39;</span><span class="p">]))</span>
<span class="n">GETM</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;latc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;xarray.core.dataarray.DataArray&#39;&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(360,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List name of dataset attributes</span>
<span class="n">GETM</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;title&#39;, &#39;history&#39;, &#39;NCO&#39;, &#39;nco_openmp_thread_number&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List variables</span>
<span class="c1">#GETM.data_vars</span>
<span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">GETM</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span> 
   <span class="nb">print</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>bathymetry
h
temp
</pre></div>
</div>
</div>
</div>
</section>
<section id="extract-variable-from-dataset">
<h2>Extract variable from dataset<a class="headerlink" href="#extract-variable-from-dataset" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">GETM</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">temp</span>

<span class="c1"># Can also use: </span>
<span class="c1"># GETM.temp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(6, 5, 360, 396)
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;temp&#x27; (time: 6, level: 5, latc: 360, lonc: 396)&gt; Size: 17MB
[4276800 values with dtype=float32]
Coordinates:
  * latc     (latc) float64 3kB 45.4 45.45 45.5 45.55 ... 63.2 63.25 63.3 63.35
  * level    (level) float64 40B 1.0 6.0 11.0 16.0 21.0
  * lonc     (lonc) float64 3kB -17.5 -17.42 -17.34 -17.26 ... 13.94 14.02 14.1
  * time     (time) datetime64[ns] 48B 1996-02-01T01:00:00 ... 1996-02-06T01:...
Attributes:
    units:        degC
    long_name:    temperature
    valid_range:  [-2. 40.]</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'temp'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 6</li><li><span class='xr-has-index'>level</span>: 5</li><li><span class='xr-has-index'>latc</span>: 360</li><li><span class='xr-has-index'>lonc</span>: 396</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-da653965-e776-4f5e-9d0a-79afed6462fc' class='xr-array-in' type='checkbox' checked><label for='section-da653965-e776-4f5e-9d0a-79afed6462fc' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[4276800 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-3b4a8a80-074a-4d9e-8083-19935b218284' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3b4a8a80-074a-4d9e-8083-19935b218284' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latc</span></div><div class='xr-var-dims'>(latc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>45.4 45.45 45.5 ... 63.3 63.35</div><input id='attrs-1422de6d-6cff-415b-a9e8-8076a0d5e488' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1422de6d-6cff-415b-a9e8-8076a0d5e488' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fe70b988-ffc4-4b50-b93d-ff4f1971f66b' class='xr-var-data-in' type='checkbox'><label for='data-fe70b988-ffc4-4b50-b93d-ff4f1971f66b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([45.400002, 45.450002, 45.500002, ..., 63.249999, 63.299999, 63.349999],
      shape=(360,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 6.0 11.0 16.0 21.0</div><input id='attrs-2b2796d8-984a-4192-9667-2a6568d0d417' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2b2796d8-984a-4192-9667-2a6568d0d417' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b160d291-42cf-4c7c-bbce-084967aac601' class='xr-var-data-in' type='checkbox'><label for='data-b160d291-42cf-4c7c-bbce-084967aac601' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>level</dd></dl></div><div class='xr-var-data'><pre>array([ 1.,  6., 11., 16., 21.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lonc</span></div><div class='xr-var-dims'>(lonc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-17.5 -17.42 -17.34 ... 14.02 14.1</div><input id='attrs-a63e2681-01a3-4b3e-9d0e-f61fb791c2e1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a63e2681-01a3-4b3e-9d0e-f61fb791c2e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-885b442d-423b-48c4-a570-2daf60fc3689' class='xr-var-data-in' type='checkbox'><label for='data-885b442d-423b-48c4-a570-2daf60fc3689' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([-17.5 , -17.42, -17.34, ...,  13.94,  14.02,  14.1 ], shape=(396,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1996-02-01T01:00:00 ... 1996-02-...</div><input id='attrs-58aa1e85-7357-4919-bd62-e6cc1a756cd7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-58aa1e85-7357-4919-bd62-e6cc1a756cd7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e5b21095-8595-47b5-b009-e26de03c829f' class='xr-var-data-in' type='checkbox'><label for='data-e5b21095-8595-47b5-b009-e26de03c829f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1996-02-01T01:00:00.000000000&#x27;, &#x27;1996-02-02T01:00:00.000000000&#x27;,
       &#x27;1996-02-03T01:00:00.000000000&#x27;, &#x27;1996-02-04T01:00:00.000000000&#x27;,
       &#x27;1996-02-05T01:00:00.000000000&#x27;, &#x27;1996-02-06T01:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-403b2a41-37ca-4c22-8785-d7ac0cbfafaa' class='xr-section-summary-in' type='checkbox'  ><label for='section-403b2a41-37ca-4c22-8785-d7ac0cbfafaa' class='xr-section-summary' >Indexes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latc</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-93c51707-691a-48c7-b04c-b8ff65d92132' class='xr-index-data-in' type='checkbox'/><label for='index-93c51707-691a-48c7-b04c-b8ff65d92132' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 45.40000166334548, 45.450001656472146, 45.500001649598815,
        45.55000164272549,  45.60000163585216, 45.650001628978835,
         45.7000016221055,  45.75000161523217,  45.80000160835885,
       45.850001601485516,
       ...
       62.899999257680534,  62.94999925080721,  62.99999924393387,
        63.04999923706055,  63.09999923018722,  63.14999922331389,
        63.19999921644056, 63.249999209567235,  63.29999920269391,
        63.34999919582057],
      dtype=&#x27;float64&#x27;, name=&#x27;latc&#x27;, length=360))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>level</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-b26145de-84ab-4379-8824-3b720ddb4f69' class='xr-index-data-in' type='checkbox'/><label for='index-b26145de-84ab-4379-8824-3b720ddb4f69' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([1.0, 6.0, 11.0, 16.0, 21.0], dtype=&#x27;float64&#x27;, name=&#x27;level&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lonc</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-30a881f8-d42a-4780-b573-9ce84aaa8357' class='xr-index-data-in' type='checkbox'/><label for='index-30a881f8-d42a-4780-b573-9ce84aaa8357' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              -17.5, -17.419999998901528, -17.339999997803055,
       -17.259999996704583, -17.179999995606106, -17.099999994507634,
        -17.01999999340916,  -16.93999999231069, -16.859999991212216,
       -16.779999990113744,
       ...
        13.380000424010593,  13.460000425109065,  13.540000426207538,
         13.62000042730601,  13.700000428404483,  13.780000429502959,
        13.860000430601431,  13.940000431699904,  14.020000432798376,
        14.100000433896849],
      dtype=&#x27;float64&#x27;, name=&#x27;lonc&#x27;, length=396))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-4a7d883e-f64c-4334-a09c-1bfcb84da942' class='xr-index-data-in' type='checkbox'/><label for='index-4a7d883e-f64c-4334-a09c-1bfcb84da942' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1996-02-01 01:00:00&#x27;, &#x27;1996-02-02 01:00:00&#x27;,
               &#x27;1996-02-03 01:00:00&#x27;, &#x27;1996-02-04 01:00:00&#x27;,
               &#x27;1996-02-05 01:00:00&#x27;, &#x27;1996-02-06 01:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e911cff9-18e8-44b3-b2da-fec72c6a9ccb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e911cff9-18e8-44b3-b2da-fec72c6a9ccb' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degC</dd><dt><span>long_name :</span></dt><dd>temperature</dd><dt><span>valid_range :</span></dt><dd>[-2. 40.]</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Check variable attributes, in the same way we access DataSet attributes</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">attrs</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Variable </span><span class="si">{}</span><span class="s1"> has units </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">],</span> <span class="n">temp</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;units&#39;: &#39;degC&#39;, &#39;long_name&#39;: &#39;temperature&#39;, &#39;valid_range&#39;: array([-2., 40.], dtype=float32)}
Variable temperature has units degC
</pre></div>
</div>
</div>
</div>
</section>
<section id="accessing-data-values">
<h2>Accessing data values<a class="headerlink" href="#accessing-data-values" title="Link to this heading">#</a></h2>
<p>Data can be subset using standard indexing methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;temp&#x27; ()&gt; Size: 4B
[1 values with dtype=float32]
Coordinates:
    latc     float64 8B 49.9
    level    float64 8B 1.0
    lonc     float64 8B -9.5
    time     datetime64[ns] 8B 1996-02-01T01:00:00
Attributes:
    units:        degC
    long_name:    temperature
    valid_range:  [-2. 40.]</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'temp'</div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-00f06564-9115-4c4e-9c3f-341e132a6bae' class='xr-array-in' type='checkbox' checked><label for='section-00f06564-9115-4c4e-9c3f-341e132a6bae' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[1 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-6699975d-8b2f-418a-ae1e-e9f757909e1e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6699975d-8b2f-418a-ae1e-e9f757909e1e' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>latc</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>49.9</div><input id='attrs-24503838-2198-4c43-9305-75172ece4668' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-24503838-2198-4c43-9305-75172ece4668' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-62695cbb-b1f3-4c30-85b9-3e1ac1afc0bc' class='xr-var-data-in' type='checkbox'><label for='data-62695cbb-b1f3-4c30-85b9-3e1ac1afc0bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array(49.90000104)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-c5b93f6a-afb3-499b-973f-e76d0a36e0f6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c5b93f6a-afb3-499b-973f-e76d0a36e0f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e8e219f8-ef21-44d4-9eba-9d7d31336ea2' class='xr-var-data-in' type='checkbox'><label for='data-e8e219f8-ef21-44d4-9eba-9d7d31336ea2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>level</dd></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lonc</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-9.5</div><input id='attrs-89fc9c22-fc6f-4720-8845-98755a7ec422' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-89fc9c22-fc6f-4720-8845-98755a7ec422' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6169d786-8f35-4586-95dc-efbd53728555' class='xr-var-data-in' type='checkbox'><label for='data-6169d786-8f35-4586-95dc-efbd53728555' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array(-9.49999989)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1996-02-01T01:00:00</div><input id='attrs-280b5740-e3f9-44f8-8519-e87086224804' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-280b5740-e3f9-44f8-8519-e87086224804' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-55a85e49-0da1-4e08-8f78-6012dd3e96b7' class='xr-var-data-in' type='checkbox'><label for='data-55a85e49-0da1-4e08-8f78-6012dd3e96b7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;1996-02-01T01:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b453c8f5-1b21-4177-98b1-657e0027e51f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b453c8f5-1b21-4177-98b1-657e0027e51f' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-21285fbc-2824-490a-a9c2-d8613017910f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-21285fbc-2824-490a-a9c2-d8613017910f' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degC</dd><dt><span>long_name :</span></dt><dd>temperature</dd><dt><span>valid_range :</span></dt><dd>[-2. 40.]</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Note that the DataArray subset keeps track of the associated coordinates, as well as other attributes.</p>
<p>Behind the scense, data values are still stored as NumPy arrays.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="n">temp</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;numpy.ndarray&#39;&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>np.float32(11.532867)
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="xarray-indexing-and-selecting-data">
<h2>Xarray Indexing and selecting data<a class="headerlink" href="#xarray-indexing-and-selecting-data" title="Link to this heading">#</a></h2>
<p>Xarray offers a variety of ways to subset your data.</p>
<p>From <a class="reference external" href="http://xarray.pydata.org/">http://xarray.pydata.org/</a>
<br>
<img src="/home/s2112771/r/sense_cpd/sense_book/book/1_python_zero2hero/figures/xarray_indexing_table.png"></p>
<p>Subsets of our temperature variable, <code class="docutils literal notranslate"><span class="pre">temp</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#positional by integer</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">temp</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">shape</span> <span class="p">)</span>
<span class="n">temp</span><span class="o">.</span><span class="n">dims</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(360, 396)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(&#39;time&#39;, &#39;level&#39;, &#39;latc&#39;, &#39;lonc&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># positional by label (coordinate value)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">temp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;1996-02-02T01:00:00&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">shape</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(360, 396)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># by name and integer - note that we use round brackets here</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">temp</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">latc</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">lonc</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(6,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># by name and label</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">temp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1996-02-02T01:00:00&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5, 360, 396)
</pre></div>
</div>
</div>
</div>
<p>Using axes names, it’s also possible to make a subset of an entire Dataset (across all variables)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GETM</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1996-02-02T01:00:00&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1f1f1f;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
  height: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: "►";
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: "▼";
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: "(";
}

.xr-dim-list:after {
  content: ")";
}

.xr-dim-list li:not(:last-child):after {
  content: ",";
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2MB
Dimensions:     (latc: 360, lonc: 396)
Coordinates:
  * latc        (latc) float64 3kB 45.4 45.45 45.5 45.55 ... 63.25 63.3 63.35
    level       float64 8B 6.0
  * lonc        (lonc) float64 3kB -17.5 -17.42 -17.34 ... 13.94 14.02 14.1
    time        datetime64[ns] 8B 1996-02-02T01:00:00
Data variables:
    bathymetry  (latc, lonc) float64 1MB ...
    h           (latc, lonc) float32 570kB ...
    temp        (latc, lonc) float32 570kB nan nan nan nan ... nan nan nan nan
Attributes:
    title:                     North West European Shelf 3nm
    history:                   Sun Nov 20 00:54:48 2016: ncks -v time,latc,lo...
    NCO:                       4.4.8
    nco_openmp_thread_number:  1</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-7a345e42-ceca-44c8-8ec1-328a1d1f1bcb' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7a345e42-ceca-44c8-8ec1-328a1d1f1bcb' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>latc</span>: 360</li><li><span class='xr-has-index'>lonc</span>: 396</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-67ea4752-1b04-4173-a989-1675318df1b1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-67ea4752-1b04-4173-a989-1675318df1b1' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latc</span></div><div class='xr-var-dims'>(latc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>45.4 45.45 45.5 ... 63.3 63.35</div><input id='attrs-898c5b31-811f-4338-84ae-013c05edea5d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-898c5b31-811f-4338-84ae-013c05edea5d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0860f301-ec08-4d6f-9d69-ddc07a7546d3' class='xr-var-data-in' type='checkbox'><label for='data-0860f301-ec08-4d6f-9d69-ddc07a7546d3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([45.400002, 45.450002, 45.500002, ..., 63.249999, 63.299999, 63.349999],
      shape=(360,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>6.0</div><input id='attrs-913364bf-bffc-4a65-9125-68471d248a3a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-913364bf-bffc-4a65-9125-68471d248a3a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c3d4298-b160-48f5-914d-3305a8e66e96' class='xr-var-data-in' type='checkbox'><label for='data-0c3d4298-b160-48f5-914d-3305a8e66e96' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>level</dd></dl></div><div class='xr-var-data'><pre>array(6.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lonc</span></div><div class='xr-var-dims'>(lonc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-17.5 -17.42 -17.34 ... 14.02 14.1</div><input id='attrs-963636bd-d15e-48ec-b6bd-e87ca32f29c9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-963636bd-d15e-48ec-b6bd-e87ca32f29c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aceb9415-2d4f-4b28-9ea4-590b83aa62ec' class='xr-var-data-in' type='checkbox'><label for='data-aceb9415-2d4f-4b28-9ea4-590b83aa62ec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([-17.5 , -17.42, -17.34, ...,  13.94,  14.02,  14.1 ], shape=(396,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1996-02-02T01:00:00</div><input id='attrs-2d760a37-851b-4a3e-9370-e71854284647' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2d760a37-851b-4a3e-9370-e71854284647' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-95e32b27-896c-4a49-bc85-56df90603c50' class='xr-var-data-in' type='checkbox'><label for='data-95e32b27-896c-4a49-bc85-56df90603c50' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;1996-02-02T01:00:00.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-20a59cbf-b114-475c-87e7-3c71aeaed158' class='xr-section-summary-in' type='checkbox'  checked><label for='section-20a59cbf-b114-475c-87e7-3c71aeaed158' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>bathymetry</span></div><div class='xr-var-dims'>(latc, lonc)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-761a01ff-950f-4346-bfe0-25b5bc1f7676' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-761a01ff-950f-4346-bfe0-25b5bc1f7676' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3851f8a2-2be4-40e9-aa9c-3222404f2fea' class='xr-var-data-in' type='checkbox'><label for='data-3851f8a2-2be4-40e9-aa9c-3222404f2fea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>bathymetry</dd><dt><span>valid_range :</span></dt><dd>[  -5. 4000.]</dd></dl></div><div class='xr-var-data'><pre>[142560 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>h</span></div><div class='xr-var-dims'>(latc, lonc)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2a32955c-d2b4-4738-bfd7-d1ed34746102' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2a32955c-d2b4-4738-bfd7-d1ed34746102' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6088f48d-4ef6-43a9-b74e-7e64be2c43a0' class='xr-var-data-in' type='checkbox'><label for='data-6088f48d-4ef6-43a9-b74e-7e64be2c43a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>long_name :</span></dt><dd>layer thickness</dd></dl></div><div class='xr-var-data'><pre>[142560 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>temp</span></div><div class='xr-var-dims'>(latc, lonc)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>nan nan nan nan ... nan nan nan nan</div><input id='attrs-d02e2c9d-6b6e-4e74-b5c9-4aebb898440b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d02e2c9d-6b6e-4e74-b5c9-4aebb898440b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3bc0d4eb-1e0f-4ccb-8f0e-9769ef85e4af' class='xr-var-data-in' type='checkbox'><label for='data-3bc0d4eb-1e0f-4ccb-8f0e-9769ef85e4af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degC</dd><dt><span>long_name :</span></dt><dd>temperature</dd><dt><span>valid_range :</span></dt><dd>[-2. 40.]</dd></dl></div><div class='xr-var-data'><pre>array([[nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       ...,
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan],
       [nan, nan, nan, ..., nan, nan, nan]], shape=(360, 396), dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-64866699-3c8a-44a0-9c2b-a7c7b59f7a0c' class='xr-section-summary-in' type='checkbox'  ><label for='section-64866699-3c8a-44a0-9c2b-a7c7b59f7a0c' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>latc</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-c9dff2d7-2b1c-4648-a973-42d71eebd3f0' class='xr-index-data-in' type='checkbox'/><label for='index-c9dff2d7-2b1c-4648-a973-42d71eebd3f0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 45.40000166334548, 45.450001656472146, 45.500001649598815,
        45.55000164272549,  45.60000163585216, 45.650001628978835,
         45.7000016221055,  45.75000161523217,  45.80000160835885,
       45.850001601485516,
       ...
       62.899999257680534,  62.94999925080721,  62.99999924393387,
        63.04999923706055,  63.09999923018722,  63.14999922331389,
        63.19999921644056, 63.249999209567235,  63.29999920269391,
        63.34999919582057],
      dtype=&#x27;float64&#x27;, name=&#x27;latc&#x27;, length=360))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lonc</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-1575ac41-c023-484c-b527-be9b83f5f49b' class='xr-index-data-in' type='checkbox'/><label for='index-1575ac41-c023-484c-b527-be9b83f5f49b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([              -17.5, -17.419999998901528, -17.339999997803055,
       -17.259999996704583, -17.179999995606106, -17.099999994507634,
        -17.01999999340916,  -16.93999999231069, -16.859999991212216,
       -16.779999990113744,
       ...
        13.380000424010593,  13.460000425109065,  13.540000426207538,
         13.62000042730601,  13.700000428404483,  13.780000429502959,
        13.860000430601431,  13.940000431699904,  14.020000432798376,
        14.100000433896849],
      dtype=&#x27;float64&#x27;, name=&#x27;lonc&#x27;, length=396))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9482f450-0152-444b-b8c3-aa763903b9cb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9482f450-0152-444b-b8c3-aa763903b9cb' class='xr-section-summary' >Attributes: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>North West European Shelf 3nm</dd><dt><span>history :</span></dt><dd>Sun Nov 20 00:54:48 2016: ncks -v time,latc,lonc,level,temp,bathymetry,h -d time,0,120,24 -d level,1,25,5 /gpfs/afmcefas/share/nwes/36x36_old/timebase/nwes-3d-199602.nc cefas_GETM_nwes.nc
Mon May  9 18:50:36 2016: ncatted -a units,time,o,c,seconds since 1996-01-01 00:00:00 /gpfs/afmcefas/share/nwes/36x36_old//timebase//nwes-3d-199602.nc
Mon May  9 17:12:29 2016: ncap2 -s time=time+2678400 /gpfs/afmcefas/share/nwes/36x36_old//nwes-3d-199602.nc /gpfs/afmcefas/share/nwes/36x36_old//timebase//nwes-3d-199602.nc
Fri May  6 23:38:06 2016 : ncmerge /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.000.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.001.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.002.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.003.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.004.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.005.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.006.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.007.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.008.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.009.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.010.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.011.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.012.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.013.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.014.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.015.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.016.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.017.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.018.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.019.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.020.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.021.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.022.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.023.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.024.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.025.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.026.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.027.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.028.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.029.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.030.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.031.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.032.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.033.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.034.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.035.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.036.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.037.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.038.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.039.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.040.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.041.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.042.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.043.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.044.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.045.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.046.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.047.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.048.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.049.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.050.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.051.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.052.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.053.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.054.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.055.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.056.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.057.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.058.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.059.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.060.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.061.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.062.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.063.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.064.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.065.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.066.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.067.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.068.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.069.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.070.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.071.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.072.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.073.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.074.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.075.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.076.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.077.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.078.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.079.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.080.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.081.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.082.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.083.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.084.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.085.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.086.par.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.087.par.nc /gpfs/scratchenv/uck09rvu/prep_par/north_west_european_shelf.3d.par.199602.nc 
 Fri May  6 23:26:28 2016: ncks -v grid_type,vert_cord,ioff,joff,dlon,dlat,lonc,latc,level,bathymetry,time,elev,u,v,h,hcc,uu,vv,w,salt,temp,sigma_t,nuh /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.000.nc /gpfs/scratchenv/uck09rvu/prep_par/1996/02/north_west_european_shelf.3d.000.par.nc
Generated by getm, ver. 2.2.2</dd><dt><span>NCO :</span></dt><dd>4.4.8</dd><dt><span>nco_openmp_thread_number :</span></dt><dd>1</dd></dl></div></li></ul></div></div></div></div>
</div>
<section id="define-selection-using-nearest-value">
<h3>Define selection using nearest value<a class="headerlink" href="#define-selection-using-nearest-value" title="Link to this heading">#</a></h3>
<p>In examples above, you use the coordinate values to make the selection by label.</p>
<p>If the value you want doesn’t exist, it is possible to interpolate e.g. to the nearest index:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GETM</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;level&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;level&#x27; (level: 5)&gt;
array([ 1.,  6., 11., 16., 21.])
Coordinates:
  * level    (level) float64 1.0 6.0 11.0 16.0 21.0
Attributes:
    units:    level</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'level'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>level</span>: 5</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e2290dce-2bd8-4161-9a67-a125c8c20956' class='xr-array-in' type='checkbox' checked><label for='section-e2290dce-2bd8-4161-9a67-a125c8c20956' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>1.0 6.0 11.0 16.0 21.0</span></div><div class='xr-array-data'><pre>array([ 1.,  6., 11., 16., 21.])</pre></div></div></li><li class='xr-section-item'><input id='section-bde900b8-4e3c-4461-9734-a46dd2f14046' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bde900b8-4e3c-4461-9734-a46dd2f14046' class='xr-section-summary' >Coordinates: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>level</span></div><div class='xr-var-dims'>(level)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0 6.0 11.0 16.0 21.0</div><input id='attrs-cacc88f9-a765-4f24-9185-886f3fedd6db' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cacc88f9-a765-4f24-9185-886f3fedd6db' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a64c237f-301b-44c7-a665-2bfa9978aa35' class='xr-var-data-in' type='checkbox'><label for='data-a64c237f-301b-44c7-a665-2bfa9978aa35' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>level</dd></dl></div><div class='xr-var-data'><pre>array([ 1.,  6., 11., 16., 21.])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-38df56de-c788-4c4a-8b29-d18df61b7b14' class='xr-section-summary-in' type='checkbox'  checked><label for='section-38df56de-c788-4c4a-8b29-d18df61b7b14' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>level</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">lonc</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">latc</span><span class="o">=</span><span class="mf">50.0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span> <span class="c1"># gives the closest to the selected variables.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;temp&#x27; (time: 6)&gt;
array([9.513756, 9.479022, 9.506635, 9.484008, 9.596508, 9.748465],
      dtype=float32)
Coordinates:
    latc     float64 50.0
    level    float64 1.0
    lonc     float64 -5.02
  * time     (time) datetime64[ns] 1996-02-01T01:00:00 ... 1996-02-06T01:00:00
Attributes:
    units:        degC
    long_name:    temperature
    valid_range:  [-2. 40.]</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'temp'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 6</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e14e7b25-c49c-4c3b-8467-52674f7faa21' class='xr-array-in' type='checkbox' checked><label for='section-e14e7b25-c49c-4c3b-8467-52674f7faa21' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>9.514 9.479 9.507 9.484 9.597 9.748</span></div><div class='xr-array-data'><pre>array([9.513756, 9.479022, 9.506635, 9.484008, 9.596508, 9.748465],
      dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-14b5801e-20f0-4404-9b88-eb0004fee33a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-14b5801e-20f0-4404-9b88-eb0004fee33a' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>latc</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>50.0</div><input id='attrs-1365e7ff-b7e0-44e9-8e09-a5bc0710f476' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1365e7ff-b7e0-44e9-8e09-a5bc0710f476' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1a641ef0-9b51-4eee-806d-35529b86b533' class='xr-var-data-in' type='checkbox'><label for='data-1a641ef0-9b51-4eee-806d-35529b86b533' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array(50.00000103)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>level</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-d77ff1aa-34bf-4579-9de3-0032cd2da585' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d77ff1aa-34bf-4579-9de3-0032cd2da585' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc9ebf67-42fb-417b-9b1b-5472969bebac' class='xr-var-data-in' type='checkbox'><label for='data-cc9ebf67-42fb-417b-9b1b-5472969bebac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>level</dd></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lonc</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-5.02</div><input id='attrs-36f446be-d789-487a-a635-9cd6c07c695e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-36f446be-d789-487a-a635-9cd6c07c695e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12c56f83-ecaf-44ff-ab78-464423b44543' class='xr-var-data-in' type='checkbox'><label for='data-12c56f83-ecaf-44ff-ab78-464423b44543' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array(-5.01999983)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1996-02-01T01:00:00 ... 1996-02-...</div><input id='attrs-89429aab-b5dc-457b-a53f-7521b494c9b0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-89429aab-b5dc-457b-a53f-7521b494c9b0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7ce38f70-c01e-420a-acae-1d33c6b53cb7' class='xr-var-data-in' type='checkbox'><label for='data-7ce38f70-c01e-420a-acae-1d33c6b53cb7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1996-02-01T01:00:00.000000000&#x27;, &#x27;1996-02-02T01:00:00.000000000&#x27;,
       &#x27;1996-02-03T01:00:00.000000000&#x27;, &#x27;1996-02-04T01:00:00.000000000&#x27;,
       &#x27;1996-02-05T01:00:00.000000000&#x27;, &#x27;1996-02-06T01:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8d65b448-a960-4d3b-a90d-a7ba6e74a9e0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8d65b448-a960-4d3b-a90d-a7ba6e74a9e0' class='xr-section-summary' >Attributes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degC</dd><dt><span>long_name :</span></dt><dd>temperature</dd><dt><span>valid_range :</span></dt><dd>[-2. 40.]</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Tolerance limits can set for “nearest” coordinate values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># e.g. latc=-50 should not yield data</span>

<span class="n">lat</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">limit</span> <span class="o">=</span> <span class="mf">0.1</span>

<span class="k">try</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lonc</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">latc</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">limit</span><span class="p">))</span>
<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ERROR: </span><span class="si">{</span><span class="n">lat</span><span class="si">}</span><span class="s1"> outside tolerance of </span><span class="si">{</span><span class="n">limit</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.DataArray &#39;temp&#39; (time: 6)&gt;
array([9.513756, 9.479022, 9.506635, 9.484008, 9.596508, 9.748465],
      dtype=float32)
Coordinates:
    latc     float64 50.0
    level    float64 1.0
    lonc     float64 -5.02
  * time     (time) datetime64[ns] 1996-02-01T01:00:00 ... 1996-02-06T01:00:00
Attributes:
    units:        degC
    long_name:    temperature
    valid_range:  [-2. 40.]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lonc</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lonc</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">latc</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lonc&#39;</span><span class="p">]</span>
<span class="n">latc</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">lonc</span><span class="o">=-</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">latc</span><span class="o">=</span><span class="n">lat</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;latc&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Note: Other <code class="docutils literal notranslate"><span class="pre">method</span></code> options available are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">backfill</span></code> / <code class="docutils literal notranslate"><span class="pre">bfill</span></code> - propagate values backward</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pad</span></code> / <code class="docutils literal notranslate"><span class="pre">ffill</span></code> - propagate values forward</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - default, exact matches only</p></li>
</ul>
<p>More information can be found in the xarray docs <a class="reference external" href="http://xarray.pydata.org/en/stable/indexing.html">here</a>.</p>
<p>You can also interpolate between values, as discussed <a class="reference internal" href="#xarray.pydata.org/en/stable/interpolation.html"><span class="xref myst">here</span></a>.</p>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="exercise-1">
<h1>Exercise 1<a class="headerlink" href="#exercise-1" title="Link to this heading">#</a></h1>
<p>From our GETM dataset (loaded above), can you extract the follow data for the ocean conditions off Great Yarmouth?<br />
The coordinates here are 52.6 deg N, 1.75 deg E.</p>
<p>a) the bathymetry (ocean depth)</p>
<p>b) the temperature profile (i.e. all levels) at the same location, on 1st February 1996?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here: </span>
<span class="c1"># Hint: can you match the latitude and longitude exactly, or do you need to find the nearest value? </span>
<span class="c1">#a)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># b)</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="plotting-is-easy">
<h1>Plotting is easy<a class="headerlink" href="#plotting-is-easy" title="Link to this heading">#</a></h1>
<p>Xarray enables simple plotting, to easily view your data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GETM</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="c1"># level[0]=1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x182793376d0&gt;
</pre></div>
</div>
<img alt="../../../_images/e344a6ce29c07237be01e170764d77283154a1787d5909a5395dc370368b7cb5.png" src="../../../_images/e344a6ce29c07237be01e170764d77283154a1787d5909a5395dc370368b7cb5.png" />
</div>
</div>
<p>It will automatically plot 2D shading or 1D lines, dependent on the shape of the DataArray.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">GETM</span><span class="o">.</span><span class="n">temp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lonc</span><span class="o">=</span><span class="mf">1.75</span><span class="p">,</span> <span class="n">latc</span><span class="o">=</span><span class="mf">52.6</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x18279382d00&gt;]
</pre></div>
</div>
<img alt="../../../_images/252fb135338fcafc1e7770b7704cd07de4b5ef5df18d97f9d7c2cc104da1b957.png" src="../../../_images/252fb135338fcafc1e7770b7704cd07de4b5ef5df18d97f9d7c2cc104da1b957.png" />
</div>
</div>
<section id="other-plotting-packages-are-still-available">
<h2>Other plotting packages are still available<a class="headerlink" href="#other-plotting-packages-are-still-available" title="Link to this heading">#</a></h2>
<p>You may still want to tailor plots to your own design e.g. creating figures for publication or presentation.</p>
<p>For example, let’s look an example with cartopy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cartopy.crs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">ccrs</span>
</pre></div>
</div>
</div>
</div>
<p>Define a general mapping function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#def make_map(ds, var=&#39;&#39;, title=None, units=None):</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_map</span><span class="p">():</span>
    <span class="c1"># create figure and axes instances</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mi">60</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">feature</span> <span class="o">=</span> <span class="n">cartopy</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;coastline&#39;</span><span class="p">,</span>
                                                  <span class="n">category</span><span class="o">=</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span>
                                                  <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">,</span>
                                                  <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span>
                                                  <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">background_patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;powderblue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

<span class="n">make_map</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\s2112771\AppData\Local\Temp\ipykernel_13860\4169181050.py:16: DeprecationWarning: The background_patch property is deprecated. Use GeoAxes.patch instead.
  ax.background_patch.set_facecolor(&#39;powderblue&#39;)
</pre></div>
</div>
<img alt="../../../_images/64bc252ea64565f40b3de0a7566050e7f380650f969958904e6befeb1be2c178.png" src="../../../_images/64bc252ea64565f40b3de0a7566050e7f380650f969958904e6befeb1be2c178.png" />
</div>
</div>
<p>We can plot our chosen data on the map, and use attributes to create annotate the figure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract our chosen data and coordinates</span>
<span class="n">latc</span> <span class="o">=</span> <span class="n">GETM</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;latc&#39;</span><span class="p">]</span>
<span class="n">lonc</span> <span class="o">=</span> <span class="n">GETM</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lonc&#39;</span><span class="p">]</span>

<span class="n">var</span> <span class="o">=</span> <span class="n">GETM</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;1996-02-02T01:00:00&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">21</span><span class="p">)</span>

<span class="c1"># Create the figure (using function above)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">make_map</span><span class="p">()</span>

<span class="c1"># draw filled contours onto the map axes (ax).</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lonc</span><span class="p">,</span> <span class="n">latc</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="c1"># add colorbar.</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="c1"># with unit label</span>
<span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>

<span class="c1"># add a title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A slice of </span><span class="si">{</span><span class="n">var</span><span class="o">.</span><span class="n">long_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\s2112771\AppData\Local\Temp\ipykernel_13860\4169181050.py:16: DeprecationWarning: The background_patch property is deprecated. Use GeoAxes.patch instead.
  ax.background_patch.set_facecolor(&#39;powderblue&#39;)
</pre></div>
</div>
<img alt="../../../_images/24cc1381163e1a525d8490039eb80505310431d1f524f346c6a6698af1c03242.png" src="../../../_images/24cc1381163e1a525d8490039eb80505310431d1f524f346c6a6698af1c03242.png" />
</div>
</div>
<hr class="docutils" />
<section id="aside-choice-of-colormaps">
<h3>Aside: Choice of colormaps<a class="headerlink" href="#aside-choice-of-colormaps" title="Link to this heading">#</a></h3>
<p>The “default” colormap in python is viridis. However, colormaps can (and should) be varied to suit the data being shown.<br />
For example, you would likely prefer a <em>sequential</em> scale for bathymetry, as opposed to a <em>diverging</em> scale for rainfall anomalies?</p>
<p>There is a large variety of maps to choose from in matplotlib, as shown <a class="reference external" href="https://matplotlib.org/2.0.1/users/colormaps.html">here</a>.</p>
<p><strong>You should always choose <em>perceptually uniform</em> shading to ensure that data is not misrepresented.</strong></p>
<p>There are a large number of articles to explaing why you should avoid using rainbow/jet e.g.</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.climate-lab-book.ac.uk/2014/end-of-the-rainbow/">The end of the rainbow</a></p></li>
<li><p><a class="reference external" href="https://blogs.mathworks.com/headlines/2018/10/10/a-dangerous-rainbow-why-colormaps-matter/">A dangerous rainbow: Why colormaps matter</a></p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="arithmetic-operations">
<h2>Arithmetic operations<a class="headerlink" href="#arithmetic-operations" title="Link to this heading">#</a></h2>
<p>You can work with DataArrays in the same way as a NumPy array.</p>
<p>Benefit here is that calculations using DataArrays will give a result that is also a DataArray.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">top</span> <span class="o">=</span> <span class="n">GETM</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">bottom</span> <span class="o">=</span> <span class="n">GETM</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">diff</span> <span class="o">=</span> <span class="n">top</span> <span class="o">-</span> <span class="n">bottom</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">diff</span><span class="p">))</span>
<span class="n">diff</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;xarray.core.dataarray.DataArray&#39;&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x1820204b0d0&gt;
</pre></div>
</div>
<img alt="../../../_images/0cb90d00f4ebfe50141b4149326186e02c9b276dcebcd2c8ea9a4b1472b3e90a.png" src="../../../_images/0cb90d00f4ebfe50141b4149326186e02c9b276dcebcd2c8ea9a4b1472b3e90a.png" />
</div>
</div>
<section id="available-methods-and-statistics">
<h3>Available methods and statistics<a class="headerlink" href="#available-methods-and-statistics" title="Link to this heading">#</a></h3>
<p>Methods available in pandas, are also available in xarray.</p>
<p>When performing calculations, can refer to dimensions by name or axis number.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># average over time (using axis number)</span>
<span class="n">time_ave</span> <span class="o">=</span> <span class="n">GETM</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">time_ave</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># average over time and level (vertical)</span>
<span class="n">timelev_ave</span> <span class="o">=</span> <span class="n">GETM</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;level&#39;</span><span class="p">])</span>
<span class="n">timelev_ave</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5, 360, 396)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x182026ab9a0&gt;
</pre></div>
</div>
<img alt="../../../_images/c8655c269d2b6683ac3a962d52582f8d8b135eba6748e39b00bd56e7c7131bde.png" src="../../../_images/c8655c269d2b6683ac3a962d52582f8d8b135eba6748e39b00bd56e7c7131bde.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># average over time and longitude </span>
<span class="c1"># i.e. zonal average (meridional section)</span>
<span class="n">timelon_ave</span> <span class="o">=</span> <span class="n">GETM</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="s1">&#39;lonc&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">timelon_ave</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x182025e5f40&gt;]
</pre></div>
</div>
<img alt="../../../_images/403cc36f01bb6457cadab0cfa12ed55585f035115d0036506d12d4c5cb2388de.png" src="../../../_images/403cc36f01bb6457cadab0cfa12ed55585f035115d0036506d12d4c5cb2388de.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="dataset-can-easily-be-saved-to-a-new-netcdf-file">
<h2>Dataset can easily be saved to a new netCDF file<a class="headerlink" href="#dataset-can-easily-be-saved-to-a-new-netcdf-file" title="Link to this heading">#</a></h2>
<p>Let’s create a new dataset, containing just the average temperature, over time and level.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a subset of the dataset, average over axes: </span>
<span class="n">ds_temp</span> <span class="o">=</span> <span class="n">GETM</span><span class="p">[[</span><span class="s1">&#39;temp&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># output to netcdf</span>
<span class="n">ds_temp</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;../../data/temp_avg_level_time.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note the extra brackets used to extract the temperature variable:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># When variable names are passed in a list, this produces a new Dataset:</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span> <span class="n">GETM</span><span class="p">[[</span><span class="s1">&#39;temp&#39;</span><span class="p">]])</span> <span class="p">)</span>

<span class="c1"># Passing just a string extracts the variable into a DataArray</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span> <span class="n">GETM</span><span class="p">[</span><span class="s1">&#39;temp&#39;</span><span class="p">])</span>   <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;xarray.core.dataset.Dataset&#39;&gt;
&lt;class &#39;xarray.core.dataarray.DataArray&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="exercise-2">
<h1>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h1>
<p>From our GETM dataset again, we want to investigate the variability of temperature with depth across the seabed.</p>
<p>a) Extract bathymetry from the dataset.</p>
<p>b) Extract temperature at the seabed (level index = 0), and average over time.</p>
<p>c) Produce a scatter plot of depth (bathymetry) vs. seabed temperature.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here: </span>
<span class="c1"># a)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># b)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># c)</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="bonus-exercise">
<h1>Bonus Exercise<a class="headerlink" href="#bonus-exercise" title="Link to this heading">#</a></h1>
<p>For those who have finished the exercises above, and want more…</p>
<p>Earlier we mentioned that you can also access remote data sets online. e.g.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">remote_data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span>
      <span class="s1">&#39;https://oceandata.sci.gsfc.nasa.gov:443/opendap/MODISA/L3SMI/2020/176/A2020176.L3m_DAY_CHL_chlor_a_9km.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>From this remote dataset:</p>
<p>a) Extract the chlorophyll concentration, covering just the North Sea (or another region of your choice).</p>
<p>b) Plot a map to show your result - check you’ve made a subset of the right region!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#def make_map(ds, var=&#39;&#39;, title=None, units=None):</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_map</span><span class="p">():</span>
    <span class="c1"># create figure and axes instances</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Stereographic</span><span class="p">(</span><span class="n">central_latitude</span><span class="o">=</span><span class="mi">60</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="mi">85</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">feature</span> <span class="o">=</span> <span class="n">cartopy</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;coastline&#39;</span><span class="p">,</span>
                                                  <span class="n">category</span><span class="o">=</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span>
                                                  <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">,</span>
                                                  <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;0.5&#39;</span><span class="p">,</span>
                                                  <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;cornsilk&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">background_patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;powderblue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

<span class="n">make_map</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\s2112771\AppData\Local\Temp\ipykernel_19216\2940847195.py:16: DeprecationWarning: The background_patch property is deprecated. Use GeoAxes.patch instead.
  ax.background_patch.set_facecolor(&#39;powderblue&#39;)
</pre></div>
</div>
<img alt="../../../_images/cbe92d061fda9f95e4f815902a6dc356dbe45f3517f2a814ef0c75aaa0fb1e95.png" src="../../../_images/cbe92d061fda9f95e4f815902a6dc356dbe45f3517f2a814ef0c75aaa0fb1e95.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here: </span>
<span class="c1"># a) </span>
<span class="c1"># Hint: You will need to extract the relevant variable over a range of latitude and londitude values.</span>
<span class="c1">#  * Find the relevant variable name to extract from the data set. </span>
<span class="c1">#  * Extract coordinate values if needed?</span>
<span class="c1">#  * Subset over your chose range of latitude and longitude. </span>


<span class="c1"># 23.811525, 90.392541 lat, lon  of dhaka</span>
<span class="n">remote_data</span><span class="o">.</span><span class="n">chlor_a</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;chlor_a&#x27; (lat: 2160, lon: 4320)&gt;
[9331200 values with dtype=float32]
Coordinates:
  * lat      (lat) float32 89.96 89.88 89.79 89.71 ... -89.79 -89.88 -89.96
  * lon      (lon) float32 -180.0 -179.9 -179.8 -179.7 ... 179.8 179.9 180.0
Attributes:
    long_name:      Chlorophyll Concentration, OCI Algorithm
    units:          mg m^-3
    standard_name:  mass_concentration_of_chlorophyll_in_sea_water
    valid_min:      0.001
    valid_max:      100.0
    reference:      Hu, C., Lee Z., and Franz, B.A. (2012). Chlorophyll-a alg...
    display_scale:  log
    display_min:    0.01
    display_max:    20.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'chlor_a'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 2160</li><li><span class='xr-has-index'>lon</span>: 4320</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-f0561d91-1fd0-4dc9-95da-60e601a0dbfa' class='xr-array-in' type='checkbox' checked><label for='section-f0561d91-1fd0-4dc9-95da-60e601a0dbfa' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>...</span></div><div class='xr-array-data'><pre>[9331200 values with dtype=float32]</pre></div></div></li><li class='xr-section-item'><input id='section-75e0d42f-26fc-4583-b370-4edf1a2b6e51' class='xr-section-summary-in' type='checkbox'  checked><label for='section-75e0d42f-26fc-4583-b370-4edf1a2b6e51' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>89.96 89.88 89.79 ... -89.88 -89.96</div><input id='attrs-d837c26c-cf34-4910-a8b4-1cfa374b43d8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d837c26c-cf34-4910-a8b4-1cfa374b43d8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40e14fd4-6961-4f5a-ab09-94f1c657d984' class='xr-var-data-in' type='checkbox'><label for='data-40e14fd4-6961-4f5a-ab09-94f1c657d984' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>valid_min :</span></dt><dd>-90.0</dd><dt><span>valid_max :</span></dt><dd>90.0</dd></dl></div><div class='xr-var-data'><pre>array([ 89.958336,  89.875   ,  89.791664, ..., -89.79167 , -89.87501 ,
       -89.958336], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-180.0 -179.9 ... 179.9 180.0</div><input id='attrs-4c71f0d2-7cae-4ebd-8775-aa3b9da2e014' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4c71f0d2-7cae-4ebd-8775-aa3b9da2e014' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-73662604-4937-4f85-a172-de16324be623' class='xr-var-data-in' type='checkbox'><label for='data-73662604-4937-4f85-a172-de16324be623' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>valid_min :</span></dt><dd>-180.0</dd><dt><span>valid_max :</span></dt><dd>180.0</dd></dl></div><div class='xr-var-data'><pre>array([-179.95833, -179.875  , -179.79167, ...,  179.79167,  179.87502,
        179.95834], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-79db568d-120b-442d-a857-c36ce0ec2776' class='xr-section-summary-in' type='checkbox'  checked><label for='section-79db568d-120b-442d-a857-c36ce0ec2776' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Chlorophyll Concentration, OCI Algorithm</dd><dt><span>units :</span></dt><dd>mg m^-3</dd><dt><span>standard_name :</span></dt><dd>mass_concentration_of_chlorophyll_in_sea_water</dd><dt><span>valid_min :</span></dt><dd>0.001</dd><dt><span>valid_max :</span></dt><dd>100.0</dd><dt><span>reference :</span></dt><dd>Hu, C., Lee Z., and Franz, B.A. (2012). Chlorophyll-a algorithms for oligotrophic oceans: A novel approach based on three-band reflectance difference, J. Geophys. Res., 117, C01011, doi:10.1029/2011JC007395.</dd><dt><span>display_scale :</span></dt><dd>log</dd><dt><span>display_min :</span></dt><dd>0.01</dd><dt><span>display_max :</span></dt><dd>20.0</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># b) </span>
<span class="c1"># Note: data is only downloaded when you make the plot</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<hr class="docutils" />
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="more-on-the-netcdf-file-format">
<h1>More on the netCDF file format<a class="headerlink" href="#more-on-the-netcdf-file-format" title="Link to this heading">#</a></h1>
<section id="history">
<h2>History<a class="headerlink" href="#history" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>netCDF is a collection of formats for storing arrays</p></li>
<li><p>popular scientific file format for gridded datasets</p>
<ul>
<li><p>netCDF classic</p>
<ul>
<li><p>more widespread</p></li>
<li><p>2 GB file limit (if you don’t use the unlimited dimension)</p></li>
<li><p>often preffered for distributing products</p></li>
</ul>
</li>
<li><p>netCDF 64 bit offset</p>
<ul>
<li><p>supports larger files</p></li>
</ul>
</li>
<li><p>NetCDF4</p>
<ul>
<li><p>based on HDF5</p></li>
<li><p>compression</p></li>
<li><p>multiple unlimited variables</p></li>
<li><p>new types inc. user defined</p></li>
<li><p>herarchical groups</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Developed by Unidata-UCAR with the aim of storing climate model data (3D+time)</p></li>
<li><p>Auxilary information about each variable can be added</p></li>
<li><p>Readable text equivalent called CDL (use ncdump/ncgen)</p></li>
<li><p>Can be used with Climate and Forecast (CF) data convention
<a class="reference external" href="http://cfconventions.org/">http://cfconventions.org/</a></p></li>
</ul>
</section>
<section id="data-model">
<h2>Data model<a class="headerlink" href="#data-model" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Dimensions:describe the axes of the data arrays.</p></li>
<li><p>Variables: N-dimensional arrays of data.</p></li>
<li><p>Attributes: annotate variables or files with small notes or supplementary metadata.</p></li>
</ul>
<p>Example for an ocean model dataset:</p>
<ul class="simple">
<li><p>Dimensions</p>
<ul>
<li><p>lat</p></li>
<li><p>lon</p></li>
<li><p>depth</p></li>
<li><p>time</p></li>
</ul>
</li>
<li><p>Variable</p>
<ul>
<li><p>Temperature</p></li>
<li><p>Salinity</p></li>
</ul>
</li>
<li><p>Global Attibutes</p>
<ul>
<li><p>Geographic grid type</p></li>
<li><p>History</p></li>
</ul>
</li>
<li><p>Variable attributes (Temperature)</p>
<ul>
<li><p>Long_name: “sea water temperature”</p></li>
<li><p>Missing_value: 1.09009E36</p></li>
<li><p>Units: deg. C</p></li>
<li><p>range: -2:50</p></li>
</ul>
</li>
</ul>
</section>
<section id="tools-for-working-with-netcdf-files">
<h2>Tools for working with netCDF files<a class="headerlink" href="#tools-for-working-with-netcdf-files" title="Link to this heading">#</a></h2>
<section id="readable-by-many-software-tools">
<h3>Readable by many software tools<a class="headerlink" href="#readable-by-many-software-tools" title="Link to this heading">#</a></h3>
<p>NetCDF can be read by many different software tools e.g. ArcGIS, QGIS, Surfer, Ferret, Paraview etc.</p>
<p>It can also be read by many different languages (one of the key motivations behind its use).</p>
</section>
<section id="c-and-fortran-libraries">
<h3>C and Fortran libraries<a class="headerlink" href="#c-and-fortran-libraries" title="Link to this heading">#</a></h3>
<p>These are used to underpin interfaces to other languages such as python (e.g. python package netCDF4)</p>
<p>Include in these are ncdump/ncgen software, used to convert to and from human-readable format.</p>
</section>
<section id="nco-tools">
<h3>nco tools<a class="headerlink" href="#nco-tools" title="Link to this heading">#</a></h3>
<p>An <em>extremely useful</em> set of tools, to process netCDF files directly from the command line.</p>
<p>For example, files can be subset, concatenated, averaged, or variables processed with simple arithmetic.</p>
<p>Full documentation, showing the wide range of functionality, can be found here: <a class="reference external" href="http://nco.sourceforge.net/nco.html">http://nco.sourceforge.net/nco.html</a>.</p>
</section>
<section id="cdo-tools">
<h3>cdo tools<a class="headerlink" href="#cdo-tools" title="Link to this heading">#</a></h3>
<p>Another powerful command line tool: <a class="reference external" href="https://code.mpimet.mpg.de/projects/cdo/">https://code.mpimet.mpg.de/projects/cdo/</a></p>
</section>
</section>
<section id="quick-viewers">
<h2>Quick viewers?<a class="headerlink" href="#quick-viewers" title="Link to this heading">#</a></h2>
<p>To view the file contents quickly and easily (without reading into python or elsewhere), there are a few different options.</p>
<p>e.g. ncdump, ncview, panoply, pyncview, etc.</p>
<section id="ncdump">
<h3>ncdump<a class="headerlink" href="#ncdump" title="Link to this heading">#</a></h3>
<p>This program should be available through your python installation, and is a useful way to quickly check the contents or attributes of a netCDF file.</p>
<p>You can peek inside your netcdf file from the prompt window (or terminal) using <code class="docutils literal notranslate"><span class="pre">ncdump</span> <span class="pre">-h</span> <span class="pre">&lt;filename&gt;</span></code></p>
<p>Be sure to use the <code class="docutils literal notranslate"><span class="pre">-h</span></code> option, otherwise it will literally dump the entire contents of your file into the screen in front of you (not what you normally want!).</p>
<p>e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ncdump -h data/cefas_GETM_nwes.nc4
netcdf cefas_GETM_nwes {
dimensions:
        latc = 360 ;
        lonc = 396 ;
        time = UNLIMITED ; // (6 currently)
        level = 5 ;
variables:
        double bathymetry(latc, lonc) ;
                bathymetry:units = &quot;m&quot; ;
                bathymetry:long_name = &quot;bathymetry&quot; ;
                bathymetry:valid_range = -5., 4000. ;
                bathymetry:_FillValue = -10. ;
                bathymetry:missing_value = -10. ;
        float h(time, level, latc, lonc) ;
                h:units = &quot;m&quot; ;
                h:long_name = &quot;layer thickness&quot; ;
                h:_FillValue = -9999.f ;
                h:missing_value = -9999.f ;
        double latc(latc) ;
                latc:units = &quot;degrees_north&quot; ;
        double level(level) ;
                level:units = &quot;level&quot; ;
        double lonc(lonc) ;
                lonc:units = &quot;degrees_east&quot; ;
        float temp(time, level, latc, lonc) ;
                temp:units = &quot;degC&quot; ;
                temp:long_name = &quot;temperature&quot; ;
                temp:valid_range = -2.f, 40.f ;
                temp:_FillValue = -9999.f ;
                temp:missing_value = -9999.f ;
        double time(time) ;
                time:long_name = &quot;time&quot; ;
                time:units = &quot;seconds since 1996-01-01 00:00:00&quot; ;
...
                
</pre></div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="references">
<h1>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h1>
<ul class="simple">
<li><p>xarray <a class="reference external" href="http://xarray.pydata.org/en/stable/">docs</a></p></li>
<li><p>netCDF4 <a class="reference external" href="https://unidata.github.io/netcdf4-python/netCDF4/index.html">docs</a></p></li>
<li><p>Stephan Hoyer’s <a class="reference external" href="https://docs.google.com/presentation/d/16CMY3g_OYr6fQplUZIDqVtG-SKZqsG8Ckwoj2oOqepU/edit#slide=id.g2b68f9254d_1_27">ECMWF talk</a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glory</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;GLORYS12V1_69.134_52.114.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glory</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (time: 335, latitude: 1, longitude: 1, depth: 2)
Coordinates:
  * latitude   (latitude) float32 69.17
  * depth      (depth) float32 186.1 222.5
  * time       (time) datetime64[ns] 1993-02-15 ... 2020-12-16T12:00:00
  * longitude  (longitude) float32 -52.08
Data variables:
    mlotst     (time, latitude, longitude) float32 45.01 74.77 ... 17.7 13.12
    siconc     (time, latitude, longitude) float32 0.9285 0.9571 ... 0.07885
    thetao     (time, depth, latitude, longitude) float32 2.498 2.966 ... 2.038
    usi        (time, latitude, longitude) float32 0.003174 ... -0.02692
    sithick    (time, latitude, longitude) float32 0.7004 0.7164 ... 0.5036
    bottomT    (time, latitude, longitude) float32 3.418 3.385 ... 2.097 2.09
    vsi        (time, latitude, longitude) float32 0.001831 ... 0.02512
    vo         (time, depth, latitude, longitude) float32 0.0006104 ... 0.001831
    uo         (time, depth, latitude, longitude) float32 0.001221 ... -0.001221
    so         (time, depth, latitude, longitude) float32 34.26 34.41 ... 34.34
    zos        (time, latitude, longitude) float32 -0.7245 -0.7816 ... -0.6488
Attributes: (12/17)
    title:                         Monthly mean fields for product GLOBAL_REA...
    references:                    http://marine.copernicus.eu
    credit:                        E.U. Copernicus Marine Service Information...
    licence:                       http://marine.copernicus.eu/services-portf...
    contact:                       servicedesk.cmems@mercator-ocean.eu
    producer:                      CMEMS - Global Monitoring and Forecasting ...
    ...                            ...
    source:                        MERCATOR GLORYS12V1
    product_user_manual:           http://marine.copernicus.eu/documents/PUM/...
    quality_information_document:  http://marine.copernicus.eu/documents/QUID...
    _CoordSysBuilder:              ucar.nc2.dataset.conv.CF1Convention
    comment:                       
    history:                       Data extracted from dataset http://localho...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-3cee8988-cfe6-4c92-9dc6-ecab656984fd' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3cee8988-cfe6-4c92-9dc6-ecab656984fd' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 335</li><li><span class='xr-has-index'>latitude</span>: 1</li><li><span class='xr-has-index'>longitude</span>: 1</li><li><span class='xr-has-index'>depth</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-0dc5017e-454f-445d-a30f-f67018b9735a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0dc5017e-454f-445d-a30f-f67018b9735a' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>69.17</div><input id='attrs-73e170b3-b2ac-4656-bd27-6d341fe2e33b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-73e170b3-b2ac-4656-bd27-6d341fe2e33b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b6de4044-f2cf-4484-88f5-7db35e8b1e4a' class='xr-var-data-in' type='checkbox'><label for='data-b6de4044-f2cf-4484-88f5-7db35e8b1e4a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>valid_min :</span></dt><dd>69.166664</dd><dt><span>valid_max :</span></dt><dd>69.166664</dd><dt><span>step :</span></dt><dd>0.08333588</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>unit_long :</span></dt><dd>Degrees North</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>_ChunkSizes :</span></dt><dd>2041</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lat</dd></dl></div><div class='xr-var-data'><pre>array([69.166664], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>depth</span></div><div class='xr-var-dims'>(depth)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>186.1 222.5</div><input id='attrs-4d7c8329-51b5-4695-9e16-769519a2e743' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4d7c8329-51b5-4695-9e16-769519a2e743' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c4baa7be-99c5-42fd-a365-33055394970f' class='xr-var-data-in' type='checkbox'><label for='data-c4baa7be-99c5-42fd-a365-33055394970f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>valid_min :</span></dt><dd>186.1256</dd><dt><span>valid_max :</span></dt><dd>222.4752</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>unit_long :</span></dt><dd>Meters</dd><dt><span>long_name :</span></dt><dd>Depth</dd><dt><span>standard_name :</span></dt><dd>depth</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>_ChunkSizes :</span></dt><dd>50</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Height</dd><dt><span>_CoordinateZisPositive :</span></dt><dd>down</dd></dl></div><div class='xr-var-data'><pre>array([186.1256, 222.4752], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1993-02-15 ... 2020-12-16T12:00:00</div><input id='attrs-09d1e42a-6df8-4456-970b-abf1e927ddde' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-09d1e42a-6df8-4456-970b-abf1e927ddde' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12cb782c-a0da-4bf3-9fc3-f9c50e5d8839' class='xr-var-data-in' type='checkbox'><label for='data-12cb782c-a0da-4bf3-9fc3-f9c50e5d8839' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>long_name :</span></dt><dd>Time (hours since 1950-01-01)</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>_ChunkSizes :</span></dt><dd>1</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Time</dd><dt><span>valid_min :</span></dt><dd>378024.0</dd><dt><span>valid_max :</span></dt><dd>622020.0</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1993-02-15T00:00:00.000000000&#x27;, &#x27;1993-03-16T12:00:00.000000000&#x27;,
       &#x27;1993-04-16T00:00:00.000000000&#x27;, ..., &#x27;2020-10-16T12:00:00.000000000&#x27;,
       &#x27;2020-11-16T00:00:00.000000000&#x27;, &#x27;2020-12-16T12:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-52.08</div><input id='attrs-d1ee5886-6e7b-495c-9ec3-d5e15ee2d17d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d1ee5886-6e7b-495c-9ec3-d5e15ee2d17d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-74f1283e-e665-4da6-b26b-5b0be1c1b1ed' class='xr-var-data-in' type='checkbox'><label for='data-74f1283e-e665-4da6-b26b-5b0be1c1b1ed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>valid_min :</span></dt><dd>-52.083332</dd><dt><span>valid_max :</span></dt><dd>-52.083332</dd><dt><span>step :</span></dt><dd>0.08332825</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>unit_long :</span></dt><dd>Degrees East</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>_ChunkSizes :</span></dt><dd>4320</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lon</dd></dl></div><div class='xr-var-data'><pre>array([-52.083332], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-52af235e-788a-4110-89b3-1b390195523b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-52af235e-788a-4110-89b3-1b390195523b' class='xr-section-summary' >Data variables: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>mlotst</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a142e674-0148-4340-a227-b837b989597c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a142e674-0148-4340-a227-b837b989597c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9d72f53a-52d7-4f32-8dd2-160656d47539' class='xr-var-data-in' type='checkbox'><label for='data-9d72f53a-52d7-4f32-8dd2-160656d47539' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Density ocean mixed layer thickness</dd><dt><span>standard_name :</span></dt><dd>ocean_mixed_layer_thickness_defined_by_sigma_theta</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>unit_long :</span></dt><dd>Meters</dd><dt><span>cell_methods :</span></dt><dd>area: mean</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1 1021 2160]</dd></dl></div><div class='xr-var-data'><pre>array([[[45.014805]],

       [[74.77035 ]],

       ...,

       [[17.700737]],

       [[13.122959]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>siconc</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-1e251771-24db-42da-a97c-b197277167f3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1e251771-24db-42da-a97c-b197277167f3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2d6a175a-df64-4df2-9e13-c1c727f7685f' class='xr-var-data-in' type='checkbox'><label for='data-2d6a175a-df64-4df2-9e13-c1c727f7685f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Ice concentration</dd><dt><span>standard_name :</span></dt><dd>sea_ice_area_fraction</dd><dt><span>units :</span></dt><dd>1</dd><dt><span>unit_long :</span></dt><dd>Fraction</dd><dt><span>cell_methods :</span></dt><dd>area: mean where sea_ice</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1 1021 2160]</dd></dl></div><div class='xr-var-data'><pre>array([[[0.928487]],

       [[0.957099]],

       ...,

       [[0.006294]],

       [[0.078852]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>thetao</span></div><div class='xr-var-dims'>(time, depth, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-3f614984-10cf-4f90-8ae3-e37e50eb14df' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3f614984-10cf-4f90-8ae3-e37e50eb14df' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0801c6eb-914f-457a-8fe9-01cebdd105e8' class='xr-var-data-in' type='checkbox'><label for='data-0801c6eb-914f-457a-8fe9-01cebdd105e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Temperature</dd><dt><span>standard_name :</span></dt><dd>sea_water_potential_temperature</dd><dt><span>units :</span></dt><dd>degrees_C</dd><dt><span>unit_long :</span></dt><dd>Degrees Celsius</dd><dt><span>cell_methods :</span></dt><dd>area: mean</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1   17  681 1440]</dd></dl></div><div class='xr-var-data'><pre>array([[[[2.497726]],

        [[2.96649 ]]],


       ...,


       [[[1.933744]],

        [[2.038485]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>usi</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-7f2bbc05-45d6-4dd7-bd42-bf15f0f73084' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7f2bbc05-45d6-4dd7-bd42-bf15f0f73084' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9d8fdbe4-cf19-465e-b903-df65bc689a1e' class='xr-var-data-in' type='checkbox'><label for='data-9d8fdbe4-cf19-465e-b903-df65bc689a1e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Sea ice eastward velocity</dd><dt><span>standard_name :</span></dt><dd>eastward_sea_ice_velocity</dd><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>unit_long :</span></dt><dd>Meters per second</dd><dt><span>cell_methods :</span></dt><dd>area: mean where sea_ice</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1 1021 2160]</dd></dl></div><div class='xr-var-data'><pre>array([[[ 0.003174]],

       [[-0.003204]],

       ...,

       [[      nan]],

       [[-0.026917]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sithick</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-0208436b-ce2c-4c8e-83fb-970b205c0284' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0208436b-ce2c-4c8e-83fb-970b205c0284' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e833794e-65da-4287-b4be-385469896fb2' class='xr-var-data-in' type='checkbox'><label for='data-e833794e-65da-4287-b4be-385469896fb2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Sea ice thickness</dd><dt><span>standard_name :</span></dt><dd>sea_ice_thickness</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>unit_long :</span></dt><dd>Meters</dd><dt><span>cell_methods :</span></dt><dd>area: mean where sea_ice</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1 1021 2160]</dd></dl></div><div class='xr-var-data'><pre>array([[[0.7004  ]],

       [[0.716422]],

       ...,

       [[0.064852]],

       [[0.503555]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bottomT</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-05f34f00-3603-4d0a-96d8-1f90e57fbd62' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-05f34f00-3603-4d0a-96d8-1f90e57fbd62' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36673f37-215b-4cdb-a33d-6474c09393b1' class='xr-var-data-in' type='checkbox'><label for='data-36673f37-215b-4cdb-a33d-6474c09393b1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Sea floor potential temperature</dd><dt><span>standard_name :</span></dt><dd>sea_water_potential_temperature_at_sea_floor</dd><dt><span>units :</span></dt><dd>degrees_C</dd><dt><span>unit_long :</span></dt><dd>Degrees Celsius</dd><dt><span>cell_methods :</span></dt><dd>area: mean</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1 1021 2160]</dd></dl></div><div class='xr-var-data'><pre>array([[[3.418409]],

       [[3.384716]],

       ...,

       [[2.09708 ]],

       [[2.089754]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vsi</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-9dc1a8ab-3f6a-4646-945d-68c02708efd6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9dc1a8ab-3f6a-4646-945d-68c02708efd6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-29700bf7-f8d4-40f7-a4e0-295d7a42f6d6' class='xr-var-data-in' type='checkbox'><label for='data-29700bf7-f8d4-40f7-a4e0-295d7a42f6d6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Sea ice northward velocity</dd><dt><span>standard_name :</span></dt><dd>northward_sea_ice_velocity</dd><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>unit_long :</span></dt><dd>Meters per second</dd><dt><span>cell_methods :</span></dt><dd>area: mean where sea_ice</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1 1021 2160]</dd></dl></div><div class='xr-var-data'><pre>array([[[ 0.001831]],

       [[-0.004852]],

       ...,

       [[      nan]],

       [[ 0.025117]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>vo</span></div><div class='xr-var-dims'>(time, depth, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-a50f5f64-cadd-4179-b7d3-8748d81b2ca2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a50f5f64-cadd-4179-b7d3-8748d81b2ca2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1d69b4aa-3261-445e-b8a1-e9106f2dffd9' class='xr-var-data-in' type='checkbox'><label for='data-1d69b4aa-3261-445e-b8a1-e9106f2dffd9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Northward velocity</dd><dt><span>standard_name :</span></dt><dd>northward_sea_water_velocity</dd><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>unit_long :</span></dt><dd>Meters per second</dd><dt><span>cell_methods :</span></dt><dd>area: mean</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1   17  681 1440]</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 0.00061 ]],

        [[-0.003052]]],


       ...,


       [[[ 0.006714]],

        [[ 0.001831]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>uo</span></div><div class='xr-var-dims'>(time, depth, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-b96a52f9-71d0-4815-800b-d2a3a2647e3b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b96a52f9-71d0-4815-800b-d2a3a2647e3b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3b20363-ad94-43ab-a21d-343ee9546717' class='xr-var-data-in' type='checkbox'><label for='data-b3b20363-ad94-43ab-a21d-343ee9546717' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Eastward velocity</dd><dt><span>standard_name :</span></dt><dd>eastward_sea_water_velocity</dd><dt><span>units :</span></dt><dd>m s-1</dd><dt><span>unit_long :</span></dt><dd>Meters per second</dd><dt><span>cell_methods :</span></dt><dd>area: mean</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1   17  681 1440]</dd></dl></div><div class='xr-var-data'><pre>array([[[[ 0.001221]],

        [[ 0.001221]]],


       ...,


       [[[-0.001221]],

        [[-0.001221]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>so</span></div><div class='xr-var-dims'>(time, depth, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d81b0fef-3a2f-4414-ad16-18fdd8b5cb86' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d81b0fef-3a2f-4414-ad16-18fdd8b5cb86' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e550e06-4c92-4c58-a3a4-ae4e2804db23' class='xr-var-data-in' type='checkbox'><label for='data-2e550e06-4c92-4c58-a3a4-ae4e2804db23' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Salinity</dd><dt><span>standard_name :</span></dt><dd>sea_water_salinity</dd><dt><span>units :</span></dt><dd>1e-3</dd><dt><span>unit_long :</span></dt><dd>Practical Salinity Unit</dd><dt><span>cell_methods :</span></dt><dd>area: mean</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1   17  681 1440]</dd></dl></div><div class='xr-var-data'><pre>array([[[[34.264656]],

        [[34.414196]]],


       ...,


       [[[34.293648]],

        [[34.337902]]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>zos</span></div><div class='xr-var-dims'>(time, latitude, longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f4a12e04-f5bb-4d05-9728-2ead5f6b03b2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f4a12e04-f5bb-4d05-9728-2ead5f6b03b2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85fb24e5-93c9-4b4b-a8e7-ab04e4430d3e' class='xr-var-data-in' type='checkbox'><label for='data-85fb24e5-93c9-4b4b-a8e7-ab04e4430d3e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Sea surface height</dd><dt><span>standard_name :</span></dt><dd>sea_surface_height_above_geoid</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>unit_long :</span></dt><dd>Meters</dd><dt><span>cell_methods :</span></dt><dd>area: mean</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1 1021 2160]</dd></dl></div><div class='xr-var-data'><pre>array([[[-0.724509]],

       [[-0.781579]],

       ...,

       [[-0.66805 ]],

       [[-0.648823]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-73666a9b-23a8-4c93-b271-fe2fd0bf3af0' class='xr-section-summary-in' type='checkbox'  ><label for='section-73666a9b-23a8-4c93-b271-fe2fd0bf3af0' class='xr-section-summary' >Attributes: <span>(17)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>title :</span></dt><dd>Monthly mean fields for product GLOBAL_REANALYSIS_PHY_001_030</dd><dt><span>references :</span></dt><dd>http://marine.copernicus.eu</dd><dt><span>credit :</span></dt><dd>E.U. Copernicus Marine Service Information (CMEMS)</dd><dt><span>licence :</span></dt><dd>http://marine.copernicus.eu/services-portfolio/service-commitments-and-licence/</dd><dt><span>contact :</span></dt><dd>servicedesk.cmems@mercator-ocean.eu</dd><dt><span>producer :</span></dt><dd>CMEMS - Global Monitoring and Forecasting Centre</dd><dt><span>institution :</span></dt><dd>Mercator Ocean</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>area :</span></dt><dd>GLOBAL</dd><dt><span>product :</span></dt><dd>GLOBAL_REANALYSIS_001_030</dd><dt><span>dataset :</span></dt><dd>global-reanalysis-001-030-monthly</dd><dt><span>source :</span></dt><dd>MERCATOR GLORYS12V1</dd><dt><span>product_user_manual :</span></dt><dd>http://marine.copernicus.eu/documents/PUM/CMEMS-GLO-PUM-001-030.pdf</dd><dt><span>quality_information_document :</span></dt><dd>http://marine.copernicus.eu/documents/QUID/CMEMS-GLO-QUID-001-030.pdf</dd><dt><span>_CoordSysBuilder :</span></dt><dd>ucar.nc2.dataset.conv.CF1Convention</dd><dt><span>comment :</span></dt><dd></dd><dt><span>history :</span></dt><dd>Data extracted from dataset http://localhost:8080/thredds/dodsC/cmems_mod_glo_phy_my_0.083_P1M-m</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glory</span><span class="p">[</span><span class="s1">&#39;thetao&#39;</span><span class="p">][:,</span><span class="mi">0</span><span class="p">,:,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;thetao&#x27; (time: 335, latitude: 1, longitude: 1)&gt;
array([[[2.497726]],

       [[2.640553]],

       ...,

       [[1.976227]],

       [[1.933744]]], dtype=float32)
Coordinates:
  * latitude   (latitude) float32 69.17
    depth      float32 186.1
  * time       (time) datetime64[ns] 1993-02-15 ... 2020-12-16T12:00:00
  * longitude  (longitude) float32 -52.08
Attributes:
    long_name:      Temperature
    standard_name:  sea_water_potential_temperature
    units:          degrees_C
    unit_long:      Degrees Celsius
    cell_methods:   area: mean
    _ChunkSizes:    [   1   17  681 1440]</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'thetao'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 335</li><li><span class='xr-has-index'>latitude</span>: 1</li><li><span class='xr-has-index'>longitude</span>: 1</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-9b35fb54-ea38-443c-be3a-c8dd98408657' class='xr-array-in' type='checkbox' checked><label for='section-9b35fb54-ea38-443c-be3a-c8dd98408657' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>2.498 2.641 2.739 2.786 2.795 2.762 ... 2.063 2.09 2.097 1.976 1.934</span></div><div class='xr-array-data'><pre>array([[[2.497726]],

       [[2.640553]],

       ...,

       [[1.976227]],

       [[1.933744]]], dtype=float32)</pre></div></div></li><li class='xr-section-item'><input id='section-5dc4cf99-1105-4dd8-8560-58d2e06e9180' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5dc4cf99-1105-4dd8-8560-58d2e06e9180' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>latitude</span></div><div class='xr-var-dims'>(latitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>69.17</div><input id='attrs-236ab0ee-5347-4369-b456-7145bd38616f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-236ab0ee-5347-4369-b456-7145bd38616f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1a3e02e7-774c-4a11-8a61-fd4c65ff5bc2' class='xr-var-data-in' type='checkbox'><label for='data-1a3e02e7-774c-4a11-8a61-fd4c65ff5bc2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>valid_min :</span></dt><dd>69.166664</dd><dt><span>valid_max :</span></dt><dd>69.166664</dd><dt><span>step :</span></dt><dd>0.08333588</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>unit_long :</span></dt><dd>Degrees North</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>_ChunkSizes :</span></dt><dd>2041</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lat</dd></dl></div><div class='xr-var-data'><pre>array([69.166664], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>depth</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>186.1</div><input id='attrs-0fe8fb03-ee2c-44e4-9f25-5b9be791aa04' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0fe8fb03-ee2c-44e4-9f25-5b9be791aa04' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8983d25c-ef2a-4187-8b99-dade8636a55e' class='xr-var-data-in' type='checkbox'><label for='data-8983d25c-ef2a-4187-8b99-dade8636a55e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>valid_min :</span></dt><dd>186.1256</dd><dt><span>valid_max :</span></dt><dd>222.4752</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>unit_long :</span></dt><dd>Meters</dd><dt><span>long_name :</span></dt><dd>Depth</dd><dt><span>standard_name :</span></dt><dd>depth</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>_ChunkSizes :</span></dt><dd>50</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Height</dd><dt><span>_CoordinateZisPositive :</span></dt><dd>down</dd></dl></div><div class='xr-var-data'><pre>array(186.1256, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1993-02-15 ... 2020-12-16T12:00:00</div><input id='attrs-b764b6bd-51d2-42a4-8044-c18cef4b9fdd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b764b6bd-51d2-42a4-8044-c18cef4b9fdd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-44c2b862-f1be-4c16-a3ca-5eb50e347b83' class='xr-var-data-in' type='checkbox'><label for='data-44c2b862-f1be-4c16-a3ca-5eb50e347b83' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>long_name :</span></dt><dd>Time (hours since 1950-01-01)</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>_ChunkSizes :</span></dt><dd>1</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Time</dd><dt><span>valid_min :</span></dt><dd>378024.0</dd><dt><span>valid_max :</span></dt><dd>622020.0</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1993-02-15T00:00:00.000000000&#x27;, &#x27;1993-03-16T12:00:00.000000000&#x27;,
       &#x27;1993-04-16T00:00:00.000000000&#x27;, ..., &#x27;2020-10-16T12:00:00.000000000&#x27;,
       &#x27;2020-11-16T00:00:00.000000000&#x27;, &#x27;2020-12-16T12:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>longitude</span></div><div class='xr-var-dims'>(longitude)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-52.08</div><input id='attrs-2e31432c-6dce-44e3-ab8f-935d5a3869e0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2e31432c-6dce-44e3-ab8f-935d5a3869e0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0618364d-0f37-494c-a4c6-7434d045c6f7' class='xr-var-data-in' type='checkbox'><label for='data-0618364d-0f37-494c-a4c6-7434d045c6f7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>valid_min :</span></dt><dd>-52.083332</dd><dt><span>valid_max :</span></dt><dd>-52.083332</dd><dt><span>step :</span></dt><dd>0.08332825</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>unit_long :</span></dt><dd>Degrees East</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>_ChunkSizes :</span></dt><dd>4320</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lon</dd></dl></div><div class='xr-var-data'><pre>array([-52.083332], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8ea79d37-bb08-4834-a94d-28901b442a32' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8ea79d37-bb08-4834-a94d-28901b442a32' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Temperature</dd><dt><span>standard_name :</span></dt><dd>sea_water_potential_temperature</dd><dt><span>units :</span></dt><dd>degrees_C</dd><dt><span>unit_long :</span></dt><dd>Degrees Celsius</dd><dt><span>cell_methods :</span></dt><dd>area: mean</dd><dt><span>_ChunkSizes :</span></dt><dd>[   1   17  681 1440]</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./book/2_geo_python/1_spatial_data_tools"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="xarray.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Xarray</p>
      </div>
    </a>
    <a class="right-next"
       href="../2_eo_data.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">2 - EO data</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Working with NetCDF files</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#netcdf-in-python">NetCDF in python</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#netcdf4">netCDF4</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xarray">xarray</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-main-advantages-of-using-xarray-versus-plain-netcdf4-are">The main advantages of using xarray versus plain netCDF4 are:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xarray-as-pandas-for-n-dimensions">Xarray as Pandas for N dimensions</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#let-s-open-a-netcdf-file">Let’s open a netCDF file</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-our-dataset">Open our dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extract-variable-from-dataset">Extract variable from dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-data-values">Accessing data values</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#xarray-indexing-and-selecting-data">Xarray Indexing and selecting data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#define-selection-using-nearest-value">Define selection using nearest value</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plotting-is-easy">Plotting is easy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#other-plotting-packages-are-still-available">Other plotting packages are still available</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#aside-choice-of-colormaps">Aside: Choice of colormaps</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-operations">Arithmetic operations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#available-methods-and-statistics">Available methods and statistics</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset-can-easily-be-saved-to-a-new-netcdf-file">Dataset can easily be saved to a new netCDF file</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-exercise">Bonus Exercise</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#more-on-the-netcdf-file-format">More on the netCDF file format</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#history">History</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-model">Data model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tools-for-working-with-netcdf-files">Tools for working with netCDF files</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#readable-by-many-software-tools">Readable by many software tools</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#c-and-fortran-libraries">C and Fortran libraries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nco-tools">nco tools</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cdo-tools">cdo tools</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#quick-viewers">Quick viewers?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ncdump">ncdump</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By SENSE CDT
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>